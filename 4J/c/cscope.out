cscope 15 $HOME/Dropbox/4J/c -q 0000000608 0000092306
	@blas/blas.h

8 #i‚de‡
BLAS_INCLUDE


9 
	#BLAS_INCLUDE


	)

12 °ru˘ { 
	mr
, 
	mi
; } 
	tfcom∂ex
;

13 °ru˘ { 
	mr
, 
	mi
; } 
	tdcom∂ex
;

14 
	tbœsboﬁ
;

16 
	~"bœ•.h
"

18 
	#FALSE
 0

	)

19 
	#TRUE
 1

	)

22 
	#MIN
(
a
,
b
Ë(◊Ë<(bË? (aË: (b))

	)

23 
	#MAX
(
a
,
b
Ë(◊Ë>(bË? (aË: (b))

	)

	@blas/blasp.h

6 #ifde‡
__˝lu•lus


10 #ifde‡
F2C_COMPAT


12 
cdŸc_
(
fcom∂ex
 *
dŸvÆ
, *
n
, fcom∂ex *
cx
, *
öcx
,

13 
fcom∂ex
 *
cy
, *
öcy
);

15 
cdŸu_
(
fcom∂ex
 *
dŸvÆ
, *
n
, fcom∂ex *
cx
, *
öcx
,

16 
fcom∂ex
 *
cy
, *
öcy
);

18 
ßsum_
(*
n
, *
sx
, *
öcx
);

20 
sˇsum_
(*
n
, 
fcom∂ex
 *
cx
, *
öcx
);

22 
s˙rm2_
(*
n
, 
fcom∂ex
 *
x
, *
öcx
);

24 
sdŸ_
(*
n
, *
sx
, *
öcx
, *
sy
, *
öcy
);

26 
¢rm2_
(*
n
, *
x
, *
öcx
);

28 
zdŸc_
(
dcom∂ex
 *
dŸvÆ
, *
n
, dcom∂ex *
cx
, *
öcx
,

29 
dcom∂ex
 *
cy
, *
öcy
);

31 
zdŸu_
(
dcom∂ex
 *
dŸvÆ
, *
n
, dcom∂ex *
cx
, *
öcx
,

32 
dcom∂ex
 *
cy
, *
öcy
);

36 
fcom∂ex
 
cdŸc_
(*
n
, fcom∂ex *
cx
, *
öcx
, fcom∂ex *
cy
, *
öcy
);

38 
fcom∂ex
 
cdŸu_
(*
n
, fcom∂ex *
cx
, *
öcx
, fcom∂ex *
cy
, *
öcy
);

40 
ßsum_
(*
n
, *
sx
, *
öcx
);

42 
sˇsum_
(*
n
, 
fcom∂ex
 *
cx
, *
öcx
);

44 
s˙rm2_
(*
n
, 
fcom∂ex
 *
x
, *
öcx
);

46 
sdŸ_
(*
n
, *
sx
, *
öcx
, *
sy
, *
öcy
);

48 
¢rm2_
(*
n
, *
x
, *
öcx
);

50 
dcom∂ex
 
zdŸc_
(*
n
, dcom∂ex *
cx
, *
öcx
, dcom∂ex *
cy
, *
öcy
);

52 
dcom∂ex
 
zdŸu_
(*
n
, dcom∂ex *
cx
, *
öcx
, dcom∂ex *
cy
, *
öcy
);

58 
ˇxpy_
(*
n
, 
fcom∂ex
 *
ˇ
, fcom∂ex *
cx
, *
öcx
, fcom∂ex *
cy
,

59 *
öcy
);

61 
cc›y_
(*
n
, 
fcom∂ex
 *
cx
, *
öcx
, fcom∂ex *
cy
, *
öcy
);

63 
cgbmv_
(*
å™s
, *
m
, *
n
, *
kl
, *
ku
,

64 
fcom∂ex
 *
Æpha
, fcom∂ex *
a
, *
lda
, fcom∂ex *
x
, *
öcx
,

65 
fcom∂ex
 *
bëa
, fcom∂ex *
y
, *
öcy
);

67 
cgemm_
(*
å™ß
, *
å™sb
, *
m
, *
n
, *
k
,

68 
fcom∂ex
 *
Æpha
, fcom∂ex *
a
, *
lda
, fcom∂ex *
b
, *
ldb
,

69 
fcom∂ex
 *
bëa
, fcom∂ex *
c
, *
ldc
);

71 
cgemv_
(*
å™s
, *
m
, *
n
, 
fcom∂ex
 *
Æpha
, fcom∂ex *
a
,

72 *
lda
, 
fcom∂ex
 *
x
, *
öcx
, fcom∂ex *
bëa
, fcom∂ex *
y
,

73 *
öcy
);

75 
cgîc_
(*
m
, *
n
, 
fcom∂ex
 *
Æpha
, fcom∂ex *
x
, *
öcx
,

76 
fcom∂ex
 *
y
, *
öcy
, fcom∂ex *
a
, *
lda
);

78 
cgîu_
(*
m
, *
n
, 
fcom∂ex
 *
Æpha
, fcom∂ex *
x
, *
öcx
,

79 
fcom∂ex
 *
y
, *
öcy
, fcom∂ex *
a
, *
lda
);

81 
chbmv_
(*
u∂o
, *
n
, *
k
, 
fcom∂ex
 *
Æpha
, fcom∂ex *
a
,

82 *
lda
, 
fcom∂ex
 *
x
, *
öcx
, fcom∂ex *
bëa
, fcom∂ex *
y
,

83 *
öcy
);

85 
chemm_
(*
side
, *
u∂o
, *
m
, *
n
, 
fcom∂ex
 *
Æpha
,

86 
fcom∂ex
 *
a
, *
lda
, fcom∂ex *
b
, *
ldb
, fcom∂ex *
bëa
,

87 
fcom∂ex
 *
c
, *
ldc
);

89 
chemv_
(*
u∂o
, *
n
, 
fcom∂ex
 *
Æpha
, fcom∂ex *
a
, *
lda
,

90 
fcom∂ex
 *
x
, *
öcx
, fcom∂ex *
bëa
, fcom∂ex *
y
, *
öcy
);

92 
chî_
(*
u∂o
, *
n
, *
Æpha
, 
fcom∂ex
 *
x
, *
öcx
,

93 
fcom∂ex
 *
a
, *
lda
);

95 
chî2_
(*
u∂o
, *
n
, 
fcom∂ex
 *
Æpha
, fcom∂ex *
x
, *
öcx
,

96 
fcom∂ex
 *
y
, *
öcy
, fcom∂ex *
a
, *
lda
);

98 
chî2k_
(*
u∂o
, *
å™s
, *
n
, *
k
, 
fcom∂ex
 *
Æpha
,

99 
fcom∂ex
 *
a
, *
lda
, fcom∂ex *
b
, *
ldb
, *
bëa
,

100 
fcom∂ex
 *
c
, *
ldc
);

102 
chîk_
(*
u∂o
, *
å™s
, *
n
, *
k
, *
Æpha
,

103 
fcom∂ex
 *
a
, *
lda
, *
bëa
, fcom∂ex *
c
, *
ldc
);

105 
chpmv_
(*
u∂o
, *
n
, 
fcom∂ex
 *
Æpha
, fcom∂ex *
≠
, fcom∂ex *
x
,

106 *
öcx
, 
fcom∂ex
 *
bëa
, fcom∂ex *
y
, *
öcy
);

108 
ch¥_
(*
u∂o
, *
n
, *
Æpha
, 
fcom∂ex
 *
x
, *
öcx
,

109 
fcom∂ex
 *
≠
);

111 
ch¥2_
(*
u∂o
, *
n
, 
fcom∂ex
 *
Æpha
, fcom∂ex *
x
, *
öcx
,

112 
fcom∂ex
 *
y
, *
öcy
, fcom∂ex *
≠
);

114 
¸Ÿg_
(
fcom∂ex
 *
ˇ
, fcom∂ex *
cb
, *
c
, fcom∂ex *
s
);

116 
csˇl_
(*
n
, 
fcom∂ex
 *
ˇ
, fcom∂ex *
cx
, *
öcx
);

118 
cssˇl_
(*
n
, *
ß
, 
fcom∂ex
 *
cx
, *
öcx
);

120 
csw≠_
(*
n
, 
fcom∂ex
 *
cx
, *
öcx
, fcom∂ex *
cy
, *
öcy
);

122 
csymm_
(*
side
, *
u∂o
, *
m
, *
n
, 
fcom∂ex
 *
Æpha
,

123 
fcom∂ex
 *
a
, *
lda
, fcom∂ex *
b
, *
ldb
, fcom∂ex *
bëa
,

124 
fcom∂ex
 *
c
, *
ldc
);

126 
csyr2k_
(*
u∂o
, *
å™s
, *
n
, *
k
, 
fcom∂ex
 *
Æpha
,

127 
fcom∂ex
 *
a
, *
lda
, fcom∂ex *
b
, *
ldb
, fcom∂ex *
bëa
,

128 
fcom∂ex
 *
c
, *
ldc
);

130 
csyrk_
(*
u∂o
, *
å™s
, *
n
, *
k
, 
fcom∂ex
 *
Æpha
,

131 
fcom∂ex
 *
a
, *
lda
, fcom∂ex *
bëa
, fcom∂ex *
c
, *
ldc
);

133 
˘bmv_
(*
u∂o
, *
å™s
, *
düg
, *
n
, *
k
,

134 
fcom∂ex
 *
a
, *
lda
, fcom∂ex *
x
, *
öcx
);

136 
˘bsv_
(*
u∂o
, *
å™s
, *
düg
, *
n
, *
k
,

137 
fcom∂ex
 *
a
, *
lda
, fcom∂ex *
x
, *
öcx
);

139 
˘pmv_
(*
u∂o
, *
å™s
, *
düg
, *
n
, 
fcom∂ex
 *
≠
,

140 
fcom∂ex
 *
x
, *
öcx
);

142 
˘psv_
(*
u∂o
, *
å™s
, *
düg
, *
n
, 
fcom∂ex
 *
≠
,

143 
fcom∂ex
 *
x
, *
öcx
);

145 
˘rmm_
(*
side
, *
u∂o
, *
å™ß
, *
düg
, *
m
,

146 *
n
, 
fcom∂ex
 *
Æpha
, fcom∂ex *
a
, *
lda
, fcom∂ex *
b
,

147 *
ldb
);

149 
˘rmv_
(*
u∂o
, *
å™s
, *
düg
, *
n
, 
fcom∂ex
 *
a
,

150 *
lda
, 
fcom∂ex
 *
x
, *
öcx
);

152 
˘rsm_
(*
side
, *
u∂o
, *
å™ß
, *
düg
, *
m
,

153 *
n
, 
fcom∂ex
 *
Æpha
, fcom∂ex *
a
, *
lda
, fcom∂ex *
b
,

154 *
ldb
);

156 
˘rsv_
(*
u∂o
, *
å™s
, *
düg
, *
n
, 
fcom∂ex
 *
a
,

157 *
lda
, 
fcom∂ex
 *
x
, *
öcx
);

159 
daxpy_
(*
n
, *
ß
, *
sx
, *
öcx
, *
sy
,

160 *
öcy
);

162 
dc›y_
(*
n
, *
sx
, *
öcx
, *
sy
, *
öcy
);

164 
dgbmv_
(*
å™s
, *
m
, *
n
, *
kl
, *
ku
,

165 *
Æpha
, *
a
, *
lda
, *
x
, *
öcx
,

166 *
bëa
, *
y
, *
öcy
);

168 
dgemm_
(*
å™ß
, *
å™sb
, *
m
, *
n
, *
k
,

169 *
Æpha
, *
a
, *
lda
, *
b
, *
ldb
,

170 *
bëa
, *
c
, *
ldc
);

172 
dgemv_
(*
å™s
, *
m
, *
n
, *
Æpha
, *
a
,

173 *
lda
, *
x
, *
öcx
, *
bëa
, *
y
,

174 *
öcy
);

176 
dgî_
(*
m
, *
n
, *
Æpha
, *
x
, *
öcx
,

177 *
y
, *
öcy
, *
a
, *
lda
);

179 
drŸ_
(*
n
, *
sx
, *
öcx
, *
sy
, *
öcy
,

180 *
c
, *
s
);

182 
drŸg_
(*
ß
, *
sb
, *
c
, *
s
);

184 
dsbmv_
(*
u∂o
, *
n
, *
k
, *
Æpha
, *
a
,

185 *
lda
, *
x
, *
öcx
, *
bëa
, *
y
,

186 *
öcy
);

188 
dsˇl_
(*
n
, *
ß
, *
sx
, *
öcx
);

190 
d•mv_
(*
u∂o
, *
n
, *
Æpha
, *
≠
, *
x
,

191 *
öcx
, *
bëa
, *
y
, *
öcy
);

193 
d•r_
(*
u∂o
, *
n
, *
Æpha
, *
x
, *
öcx
,

194 *
≠
);

196 
d•r2_
(*
u∂o
, *
n
, *
Æpha
, *
x
, *
öcx
,

197 *
y
, *
öcy
, *
≠
);

199 
dsw≠_
(*
n
, *
sx
, *
öcx
, *
sy
, *
öcy
);

201 
dsymm_
(*
side
, *
u∂o
, *
m
, *
n
, *
Æpha
,

202 *
a
, *
lda
, *
b
, *
ldb
, *
bëa
,

203 *
c
, *
ldc
);

205 
dsymv_
(*
u∂o
, *
n
, *
Æpha
, *
a
, *
lda
,

206 *
x
, *
öcx
, *
bëa
, *
y
, *
öcy
);

208 
dsyr_
(*
u∂o
, *
n
, *
Æpha
, *
x
, *
öcx
,

209 *
a
, *
lda
);

211 
dsyr2_
(*
u∂o
, *
n
, *
Æpha
, *
x
, *
öcx
,

212 *
y
, *
öcy
, *
a
, *
lda
);

214 
dsyr2k_
(*
u∂o
, *
å™s
, *
n
, *
k
, *
Æpha
,

215 *
a
, *
lda
, *
b
, *
ldb
, *
bëa
,

216 *
c
, *
ldc
);

218 
dsyrk_
(*
u∂o
, *
å™s
, *
n
, *
k
, *
Æpha
,

219 *
a
, *
lda
, *
bëa
, *
c
, *
ldc
);

221 
dtbmv_
(*
u∂o
, *
å™s
, *
düg
, *
n
, *
k
,

222 *
a
, *
lda
, *
x
, *
öcx
);

224 
dtbsv_
(*
u∂o
, *
å™s
, *
düg
, *
n
, *
k
,

225 *
a
, *
lda
, *
x
, *
öcx
);

227 
dçmv_
(*
u∂o
, *
å™s
, *
düg
, *
n
, *
≠
,

228 *
x
, *
öcx
);

230 
dçsv_
(*
u∂o
, *
å™s
, *
düg
, *
n
, *
≠
,

231 *
x
, *
öcx
);

233 
dåmm_
(*
side
, *
u∂o
, *
å™ß
, *
düg
, *
m
,

234 *
n
, *
Æpha
, *
a
, *
lda
, *
b
,

235 *
ldb
);

237 
dåmv_
(*
u∂o
, *
å™s
, *
düg
, *
n
, *
a
,

238 *
lda
, *
x
, *
öcx
);

240 
dåsm_
(*
side
, *
u∂o
, *
å™ß
, *
düg
, *
m
,

241 *
n
, *
Æpha
, *
a
, *
lda
, *
b
,

242 *
ldb
);

244 
dåsv_
(*
u∂o
, *
å™s
, *
düg
, *
n
, *
a
,

245 *
lda
, *
x
, *
öcx
);

248 
ßxpy_
(*
n
, *
ß
, *
sx
, *
öcx
, *
sy
, *
öcy
);

250 
sc›y_
(*
n
, *
sx
, *
öcx
, *
sy
, *
öcy
);

252 
sgbmv_
(*
å™s
, *
m
, *
n
, *
kl
, *
ku
,

253 *
Æpha
, *
a
, *
lda
, *
x
, *
öcx
,

254 *
bëa
, *
y
, *
öcy
);

256 
sgemm_
(*
å™ß
, *
å™sb
, *
m
, *
n
, *
k
,

257 *
Æpha
, *
a
, *
lda
, *
b
, *
ldb
,

258 *
bëa
, *
c
, *
ldc
);

260 
sgemv_
(*
å™s
, *
m
, *
n
, *
Æpha
, *
a
,

261 *
lda
, *
x
, *
öcx
, *
bëa
, *
y
,

262 *
öcy
);

264 
sgî_
(*
m
, *
n
, *
Æpha
, *
x
, *
öcx
,

265 *
y
, *
öcy
, *
a
, *
lda
);

267 
§Ÿ_
(*
n
, *
sx
, *
öcx
, *
sy
, *
öcy
,

268 *
c
, *
s
);

270 
§Ÿg_
(*
ß
, *
sb
, *
c
, *
s
);

272 
ssbmv_
(*
u∂o
, *
n
, *
k
, *
Æpha
, *
a
,

273 *
lda
, *
x
, *
öcx
, *
bëa
, *
y
,

274 *
öcy
);

276 
ssˇl_
(*
n
, *
ß
, *
sx
, *
öcx
);

278 
s•mv_
(*
u∂o
, *
n
, *
Æpha
, *
≠
, *
x
,

279 *
öcx
, *
bëa
, *
y
, *
öcy
);

281 
s•r_
(*
u∂o
, *
n
, *
Æpha
, *
x
, *
öcx
,

282 *
≠
);

284 
s•r2_
(*
u∂o
, *
n
, *
Æpha
, *
x
, *
öcx
,

285 *
y
, *
öcy
, *
≠
);

287 
ssw≠_
(*
n
, *
sx
, *
öcx
, *
sy
, *
öcy
);

289 
ssymm_
(*
side
, *
u∂o
, *
m
, *
n
, *
Æpha
,

290 *
a
, *
lda
, *
b
, *
ldb
, *
bëa
,

291 *
c
, *
ldc
);

293 
ssymv_
(*
u∂o
, *
n
, *
Æpha
, *
a
, *
lda
,

294 *
x
, *
öcx
, *
bëa
, *
y
, *
öcy
);

296 
ssyr_
(*
u∂o
, *
n
, *
Æpha
, *
x
, *
öcx
,

297 *
a
, *
lda
);

299 
ssyr2_
(*
u∂o
, *
n
, *
Æpha
, *
x
, *
öcx
,

300 *
y
, *
öcy
, *
a
, *
lda
);

302 
ssyr2k_
(*
u∂o
, *
å™s
, *
n
, *
k
, *
Æpha
,

303 *
a
, *
lda
, *
b
, *
ldb
, *
bëa
,

304 *
c
, *
ldc
);

306 
ssyrk_
(*
u∂o
, *
å™s
, *
n
, *
k
, *
Æpha
,

307 *
a
, *
lda
, *
bëa
, *
c
, *
ldc
);

309 
°bmv_
(*
u∂o
, *
å™s
, *
düg
, *
n
, *
k
,

310 *
a
, *
lda
, *
x
, *
öcx
);

312 
°bsv_
(*
u∂o
, *
å™s
, *
düg
, *
n
, *
k
,

313 *
a
, *
lda
, *
x
, *
öcx
);

315 
°pmv_
(*
u∂o
, *
å™s
, *
düg
, *
n
, *
≠
,

316 *
x
, *
öcx
);

318 
°psv_
(*
u∂o
, *
å™s
, *
düg
, *
n
, *
≠
,

319 *
x
, *
öcx
);

321 
°rmm_
(*
side
, *
u∂o
, *
å™ß
, *
düg
, *
m
,

322 *
n
, *
Æpha
, *
a
, *
lda
, *
b
,

323 *
ldb
);

325 
°rmv_
(*
u∂o
, *
å™s
, *
düg
, *
n
, *
a
,

326 *
lda
, *
x
, *
öcx
);

328 
°rsm_
(*
side
, *
u∂o
, *
å™ß
, *
düg
, *
m
,

329 *
n
, *
Æpha
, *
a
, *
lda
, *
b
,

330 *
ldb
);

332 
°rsv_
(*
u∂o
, *
å™s
, *
düg
, *
n
, *
a
,

333 *
lda
, *
x
, *
öcx
);

335 
zaxpy_
(*
n
, 
dcom∂ex
 *
ˇ
, dcom∂ex *
cx
, *
öcx
, dcom∂ex *
cy
,

336 *
öcy
);

338 
zc›y_
(*
n
, 
dcom∂ex
 *
cx
, *
öcx
, dcom∂ex *
cy
, *
öcy
);

340 
zdsˇl_
(*
n
, *
ß
, 
dcom∂ex
 *
cx
, *
öcx
);

342 
zgbmv_
(*
å™s
, *
m
, *
n
, *
kl
, *
ku
,

343 
dcom∂ex
 *
Æpha
, dcom∂ex *
a
, *
lda
, dcom∂ex *
x
, *
öcx
,

344 
dcom∂ex
 *
bëa
, dcom∂ex *
y
, *
öcy
);

346 
zgemm_
(*
å™ß
, *
å™sb
, *
m
, *
n
, *
k
,

347 
dcom∂ex
 *
Æpha
, dcom∂ex *
a
, *
lda
, dcom∂ex *
b
, *
ldb
,

348 
dcom∂ex
 *
bëa
, dcom∂ex *
c
, *
ldc
);

350 
zgemv_
(*
å™s
, *
m
, *
n
, 
dcom∂ex
 *
Æpha
, dcom∂ex *
a
,

351 *
lda
, 
dcom∂ex
 *
x
, *
öcx
, dcom∂ex *
bëa
, dcom∂ex *
y
,

352 *
öcy
);

354 
zgîc_
(*
m
, *
n
, 
dcom∂ex
 *
Æpha
, dcom∂ex *
x
, *
öcx
,

355 
dcom∂ex
 *
y
, *
öcy
, dcom∂ex *
a
, *
lda
);

357 
zgîu_
(*
m
, *
n
, 
dcom∂ex
 *
Æpha
, dcom∂ex *
x
, *
öcx
,

358 
dcom∂ex
 *
y
, *
öcy
, dcom∂ex *
a
, *
lda
);

360 
zhbmv_
(*
u∂o
, *
n
, *
k
, 
dcom∂ex
 *
Æpha
, dcom∂ex *
a
,

361 *
lda
, 
dcom∂ex
 *
x
, *
öcx
, dcom∂ex *
bëa
, dcom∂ex *
y
,

362 *
öcy
);

364 
zhemm_
(*
side
, *
u∂o
, *
m
, *
n
, 
dcom∂ex
 *
Æpha
,

365 
dcom∂ex
 *
a
, *
lda
, dcom∂ex *
b
, *
ldb
, dcom∂ex *
bëa
,

366 
dcom∂ex
 *
c
, *
ldc
);

368 
zhemv_
(*
u∂o
, *
n
, 
dcom∂ex
 *
Æpha
, dcom∂ex *
a
, *
lda
,

369 
dcom∂ex
 *
x
, *
öcx
, dcom∂ex *
bëa
, dcom∂ex *
y
, *
öcy
);

371 
zhî_
(*
u∂o
, *
n
, *
Æpha
, 
dcom∂ex
 *
x
, *
öcx
,

372 
dcom∂ex
 *
a
, *
lda
);

374 
zhî2_
(*
u∂o
, *
n
, 
dcom∂ex
 *
Æpha
, dcom∂ex *
x
, *
öcx
,

375 
dcom∂ex
 *
y
, *
öcy
, dcom∂ex *
a
, *
lda
);

377 
zhî2k_
(*
u∂o
, *
å™s
, *
n
, *
k
, 
dcom∂ex
 *
Æpha
,

378 
dcom∂ex
 *
a
, *
lda
, dcom∂ex *
b
, *
ldb
, *
bëa
,

379 
dcom∂ex
 *
c
, *
ldc
);

381 
zhîk_
(*
u∂o
, *
å™s
, *
n
, *
k
, *
Æpha
,

382 
dcom∂ex
 *
a
, *
lda
, *
bëa
, dcom∂ex *
c
, *
ldc
);

384 
zhpmv_
(*
u∂o
, *
n
, 
dcom∂ex
 *
Æpha
, dcom∂ex *
≠
, dcom∂ex *
x
,

385 *
öcx
, 
dcom∂ex
 *
bëa
, dcom∂ex *
y
, *
öcy
);

387 
zh¥_
(*
u∂o
, *
n
, *
Æpha
, 
dcom∂ex
 *
x
, *
öcx
,

388 
dcom∂ex
 *
≠
);

390 
zh¥2_
(*
u∂o
, *
n
, 
dcom∂ex
 *
Æpha
, dcom∂ex *
x
, *
öcx
,

391 
dcom∂ex
 *
y
, *
öcy
, dcom∂ex *
≠
);

393 
zrŸg_
(
dcom∂ex
 *
ˇ
, dcom∂ex *
cb
, *
c
, dcom∂ex *
s
);

395 
zsˇl_
(*
n
, 
dcom∂ex
 *
ˇ
, dcom∂ex *
cx
, *
öcx
);

397 
zsw≠_
(*
n
, 
dcom∂ex
 *
cx
, *
öcx
, dcom∂ex *
cy
, *
öcy
);

399 
zsymm_
(*
side
, *
u∂o
, *
m
, *
n
, 
dcom∂ex
 *
Æpha
,

400 
dcom∂ex
 *
a
, *
lda
, dcom∂ex *
b
, *
ldb
, dcom∂ex *
bëa
,

401 
dcom∂ex
 *
c
, *
ldc
);

403 
zsyr2k_
(*
u∂o
, *
å™s
, *
n
, *
k
, 
dcom∂ex
 *
Æpha
,

404 
dcom∂ex
 *
a
, *
lda
, dcom∂ex *
b
, *
ldb
, dcom∂ex *
bëa
,

405 
dcom∂ex
 *
c
, *
ldc
);

407 
zsyrk_
(*
u∂o
, *
å™s
, *
n
, *
k
, 
dcom∂ex
 *
Æpha
,

408 
dcom∂ex
 *
a
, *
lda
, dcom∂ex *
bëa
, dcom∂ex *
c
, *
ldc
);

410 
ztbmv_
(*
u∂o
, *
å™s
, *
düg
, *
n
, *
k
,

411 
dcom∂ex
 *
a
, *
lda
, dcom∂ex *
x
, *
öcx
);

413 
ztbsv_
(*
u∂o
, *
å™s
, *
düg
, *
n
, *
k
,

414 
dcom∂ex
 *
a
, *
lda
, dcom∂ex *
x
, *
öcx
);

416 
zçmv_
(*
u∂o
, *
å™s
, *
düg
, *
n
, 
dcom∂ex
 *
≠
,

417 
dcom∂ex
 *
x
, *
öcx
);

419 
zçsv_
(*
u∂o
, *
å™s
, *
düg
, *
n
, 
dcom∂ex
 *
≠
,

420 
dcom∂ex
 *
x
, *
öcx
);

422 
zåmm_
(*
side
, *
u∂o
, *
å™ß
, *
düg
, *
m
,

423 *
n
, 
dcom∂ex
 *
Æpha
, dcom∂ex *
a
, *
lda
, dcom∂ex *
b
,

424 *
ldb
);

426 
zåmv_
(*
u∂o
, *
å™s
, *
düg
, *
n
, 
dcom∂ex
 *
a
,

427 *
lda
, 
dcom∂ex
 *
x
, *
öcx
);

429 
zåsm_
(*
side
, *
u∂o
, *
å™ß
, *
düg
, *
m
,

430 *
n
, 
dcom∂ex
 *
Æpha
, dcom∂ex *
a
, *
lda
, dcom∂ex *
b
,

431 *
ldb
);

433 
zåsv_
(*
u∂o
, *
å™s
, *
düg
, *
n
, 
dcom∂ex
 *
a
,

434 *
lda
, 
dcom∂ex
 *
x
, *
öcx
);

436 #ifde‡
__˝lu•lus


	@blas/daxpy.c

1 
	~"bœs.h
"

3 #ifde‡
__˝lu•lus


7 
daxpy_
(*
n
, *
ß
, *
sx
, *
öcx
, *
sy
,

8 *
öcy
)

10 
i
, 
m
, 
ix
, 
iy
, 
¬
, 
iöcx
, 
iöcy
;

11 
sß
;

19 
¬
 = *
n
;

20 
sß
 = *
ß
;

21 
iöcx
 = *
öcx
;

22 
iöcy
 = *
öcy
;

24 if–
¬
 > 0 && 
sß
 != 0.0 )

26 i‡(
iöcx
 =1 && 
iöcy
 == 1)

28 
m
 = 
¬
-3;

29 
i
 = 0; i < 
m
; i += 4)

31 
sy
[
i
] +
sß
 * 
sx
[i];

32 
sy
[
i
+1] +
sß
 * 
sx
[i+1];

33 
sy
[
i
+2] +
sß
 * 
sx
[i+2];

34 
sy
[
i
+3] +
sß
 * 
sx
[i+3];

36  ; 
i
 < 
¬
; ++i)

37 
sy
[
i
] +
sß
 * 
sx
[i];

41 
ix
 = 
iöcx
 >0 ? 0 : (1 - 
¬
) * iincx;

42 
iy
 = 
iöcy
 >0 ? 0 : (1 - 
¬
) * iincy;

43 
i
 = 0; i < 
¬
; i++)

45 
sy
[
iy
] +
sß
 * 
sx
[
ix
];

46 
ix
 +
iöcx
;

47 
iy
 +
iöcy
;

55 #ifde‡
__˝lu•lus


	@blas/ddot.c

1 
	~"bœs.h
"

3 #ifde‡
__˝lu•lus


7 
ddŸ_
(*
n
, *
sx
, *
öcx
, *
sy
, *
öcy
)

9 
i
, 
m
, 
¬
, 
iöcx
, 
iöcy
;

10 
°emp
;

11 
ix
, 
iy
;

19 
¬
 = *
n
;

20 
iöcx
 = *
öcx
;

21 
iöcy
 = *
öcy
;

23 
°emp
 = 0.0;

24 i‡(
¬
 > 0)

26 i‡(
iöcx
 =1 && 
iöcy
 == 1)

28 
m
 = 
¬
-4;

29 
i
 = 0; i < 
m
; i += 5)

30 
°emp
 +
sx
[
i
] * 
sy
[i] + sx[i+1] * sy[i+1] + sx[i+2] * sy[i+2] +

31 
sx
[
i
+3] * 
sy
[i+3] + sx[i+4] * sy[i+4];

33  ; 
i
 < 
¬
; i++)

34 
°emp
 +
sx
[
i
] * 
sy
[i];

38 
ix
 = 0;

39 
iy
 = 0;

40 i‡(
iöcx
 < 0)

41 
ix
 = (1 - 
¬
Ë* 
iöcx
;

42 i‡(
iöcy
 < 0)

43 
iy
 = (1 - 
¬
Ë* 
iöcy
;

44 
i
 = 0; i < 
¬
; i++)

46 
°emp
 +
sx
[
ix
] * 
sy
[
iy
];

47 
ix
 +
iöcx
;

48 
iy
 +
iöcy
;

53  
°emp
;

56 #ifde‡
__˝lu•lus


	@blas/dnrm2.c

1 
	~<m©h.h
>

2 
	~"bœs.h
"

4 #ifde‡
__˝lu•lus


8 
dƒm2_
(*
n
, *
x
, *
öcx
)

10 
ix
, 
¬
, 
iöcx
;

11 
n‹m
, 
sˇÀ
, 
absxi
, 
ssq
, 
ãmp
;

23 
¬
 = *
n
;

24 
iöcx
 = *
öcx
;

26 if–
¬
 > 0 && 
iöcx
 > 0 )

28 i‡(
¬
 == 1)

30 
n‹m
 = 
Ábs
(
x
[0]);

34 
sˇÀ
 = 0.0;

35 
ssq
 = 1.0;

40 
ix
=(
¬
-1)*
iöcx
; ix>=0; ix-=iincx)

42 i‡(
x
[
ix
] != 0.0)

44 
absxi
 = 
Ábs
(
x
[
ix
]);

45 i‡(
sˇÀ
 < 
absxi
)

47 
ãmp
 = 
sˇÀ
 / 
absxi
;

48 
ssq
 = ssq * (
ãmp
 *Åemp) + 1.0;

49 
sˇÀ
 = 
absxi
;

53 
ãmp
 = 
absxi
 / 
sˇÀ
;

54 
ssq
 +
ãmp
 *Åemp;

58 
n‹m
 = 
sˇÀ
 * 
sqπ
(
ssq
);

62 
n‹m
 = 0.0;

64  
n‹m
;

68 #ifde‡
__˝lu•lus


	@blas/dscal.c

1 
	~"bœs.h
"

3 #ifde‡
__˝lu•lus


7 
dsˇl_
(*
n
, *
ß
, *
sx
, *
öcx
)

9 
i
, 
m
, 
nöcx
, 
¬
, 
iöcx
;

10 
sß
;

19 
¬
 = *
n
;

20 
iöcx
 = *
öcx
;

21 
sß
 = *
ß
;

23 i‡(
¬
 > 0 && 
iöcx
 > 0)

25 i‡(
iöcx
 == 1)

27 
m
 = 
¬
-4;

28 
i
 = 0; i < 
m
; i += 5)

30 
sx
[
i
] = 
sß
 * sx[i];

31 
sx
[
i
+1] = 
sß
 * sx[i+1];

32 
sx
[
i
+2] = 
sß
 * sx[i+2];

33 
sx
[
i
+3] = 
sß
 * sx[i+3];

34 
sx
[
i
+4] = 
sß
 * sx[i+4];

36  ; 
i
 < 
¬
; ++i)

37 
sx
[
i
] = 
sß
 * sx[i];

41 
nöcx
 = 
¬
 * 
iöcx
;

42 
i
 = 0; i < 
nöcx
; i +
iöcx
)

43 
sx
[
i
] = 
sß
 * sx[i];

50 #ifde‡
__˝lu•lus


	@linear.cpp

1 
	~<m©h.h
>

2 
	~<°dio.h
>

3 
	~<°dlib.h
>

4 
	~<°rög.h
>

5 
	~<°d¨g.h
>

6 
	~<loˇÀ.h
>

7 
	~"löór.h
"

8 
	~"å⁄.h
"

9 sig√d 
	tsch¨
;

10 
	gãm∂©e
 <
˛ass
 
	gT
> 
ölöe
 
	$sw≠
(
T
& 
x
, T& 
y
Ë{ T 
t
=x; x=y; yÒ; 
	}
}

11 #i‚de‡
mö


12 
	gãm∂©e
 <
˛ass
 
	gT
> 
ölöe
 
T
 
	$mö
(
T
 
x
,T 
y
Ë{  (x<y)?x:y; 
	}
}

14 #i‚de‡
max


15 
	gãm∂©e
 <
˛ass
 
	gT
> 
ölöe
 
T
 
	$max
(
T
 
x
,T 
y
Ë{  (x>y)?x:y; 
	}
}

17 
	gãm∂©e
 <
˛ass
 
	gS
, cœs†
	gT
> 
ölöe
 
	$˛⁄e
(
T
*& 
d°
, 
S
* 
§c
, 
n
)

19 
d°
 = 
√w
 
T
[
n
];

20 
	`mem˝y
((*)
d°
,(*)
§c
,(
T
)*
n
);

21 
	}
}

22 
	#MÆloc
(
ty≥
,
n
Ë—y≥ *)
	`mÆloc
(“)*—y≥))

	)

23 
	#INF
 
HUGE_VAL


	)

25 
	$¥öt_°rög_°dout
(c⁄° *
s
)

27 
	`Âuts
(
s
,
°dout
);

28 
	`fÊush
(
°dout
);

29 
	}
}

31 (*
liblöór_¥öt_°rög
Ë(c⁄° *Ë&
¥öt_°rög_°dout
;

34 
	$öfo
(c⁄° *
fmt
,...)

36 
buf
[
BUFSIZ
];

37 
va_li°
 
≠
;

38 
	`va_°¨t
(
≠
,
fmt
);

39 
	`v•rötf
(
buf
,
fmt
,
≠
);

40 
	`va_íd
(
≠
);

41 (*
liblöór_¥öt_°rög
)(
buf
);

42 
	}
}

44 
	$öfo
(c⁄° *
fmt
,...Ë{
	}
}

47 ˛as†
	cl2r_Ã_fun
: 
public
 
fun˘i⁄


49 
public
:

50 
l2r_Ã_fun
(c⁄° 
¥obÀm
 *
¥ob
, *
C
);

51 ~
l2r_Ã_fun
();

53 
fun
(*
w
);

54 
gød
(*
w
, *
g
);

55 
Hv
(*
s
, *
Hs
);

57 
gë_ƒ_v¨übÀ
();

59 
	m¥iv©e
:

60 
Xv
(*
v
, *Xv);

61 
XTv
(*
v
, *XTv);

63 *
	mC
;

64 *
	mz
;

65 *
	mD
;

66 c⁄° 
¥obÀm
 *
	m¥ob
;

69 
	gl2r_Ã_fun
::
	$l2r_Ã_fun
(c⁄° 
¥obÀm
 *
¥ob
, *
C
)

71 
l
=
¥ob
->l;

73 
this
->
¥ob
 =Örob;

75 
z
 = 
√w
 [
l
];

76 
D
 = 
√w
 [
l
];

77 
this
->
C
 = C;

78 
	}
}

80 
	gl2r_Ã_fun
::~
	$l2r_Ã_fun
()

82 
dñëe
[] 
z
;

83 
dñëe
[] 
D
;

84 
	}
}

87 
	gl2r_Ã_fun
::
	$fun
(*
w
)

89 
i
;

90 
f
=0;

91 *
y
=
¥ob
->y;

92 
l
=
¥ob
->l;

93 
w_size
=
	`gë_ƒ_v¨übÀ
();

95 
	`Xv
(
w
, 
z
);

97 
i
=0;i<
w_size
;i++)

98 
f
 +
w
[
i
]*w[i];

99 
f
 /= 2.0;

100 
i
=0;i<
l
;i++)

102 
yz
 = 
y
[
i
]*
z
[i];

103 i‡(
yz
 >= 0)

104 
f
 +
C
[
i
]*
	`log
(1 + 
	`exp
(-
yz
));

106 
f
 +
C
[
i
]*(-
yz
+
	`log
(1 + 
	`exp
(yz)));

109 (
f
);

110 
	}
}

112 
	gl2r_Ã_fun
::
	$gød
(*
w
, *
g
)

114 
i
;

115 *
y
=
¥ob
->y;

116 
l
=
¥ob
->l;

117 
w_size
=
	`gë_ƒ_v¨übÀ
();

119 
i
=0;i<
l
;i++)

121 
z
[
i
] = 1/(1 + 
	`exp
(-
y
[i]*z[i]));

122 
D
[
i
] = 
z
[i]*(1-z[i]);

123 
z
[
i
] = 
C
[i]*(z[i]-1)*
y
[i];

125 
	`XTv
(
z
, 
g
);

127 
i
=0;i<
w_size
;i++)

128 
g
[
i
] = 
w
[i] + g[i];

129 
	}
}

131 
	gl2r_Ã_fun
::
	$gë_ƒ_v¨übÀ
()

133  
¥ob
->
n
;

134 
	}
}

136 
	gl2r_Ã_fun
::
	$Hv
(*
s
, *
Hs
)

138 
i
;

139 
l
=
¥ob
->l;

140 
w_size
=
	`gë_ƒ_v¨übÀ
();

141 *
wa
 = 
√w
 [
l
];

143 
	`Xv
(
s
, 
wa
);

144 
i
=0;i<
l
;i++)

145 
wa
[
i
] = 
C
[i]*
D
[i]*wa[i];

147 
	`XTv
(
wa
, 
Hs
);

148 
i
=0;i<
w_size
;i++)

149 
Hs
[
i
] = 
s
[i] + Hs[i];

150 
dñëe
[] 
wa
;

151 
	}
}

153 
	gl2r_Ã_fun
::
	$Xv
(*
v
, *
Xv
)

155 
i
;

156 
l
=
¥ob
->l;

157 
„©uª_node
 **
x
=
¥ob
->x;

159 
i
=0;i<
l
;i++)

161 
„©uª_node
 *
s
=
x
[
i
];

162 
Xv
[
i
]=0;

163 
s
->
ödex
!=-1)

165 
Xv
[
i
]+=
v
[
s
->
ödex
-1]*s->
vÆue
;

166 
s
++;

169 
	}
}

171 
	gl2r_Ã_fun
::
	$XTv
(*
v
, *
XTv
)

173 
i
;

174 
l
=
¥ob
->l;

175 
w_size
=
	`gë_ƒ_v¨übÀ
();

176 
„©uª_node
 **
x
=
¥ob
->x;

178 
i
=0;i<
w_size
;i++)

179 
XTv
[
i
]=0;

180 
i
=0;i<
l
;i++)

182 
„©uª_node
 *
s
=
x
[
i
];

183 
s
->
ödex
!=-1)

185 
XTv
[
s
->
ödex
-1]+=
v
[
i
]*s->
vÆue
;

186 
s
++;

189 
	}
}

191 ˛as†
	cl2r_l2_svc_fun
: 
public
 
fun˘i⁄


193 
public
:

194 
l2r_l2_svc_fun
(c⁄° 
¥obÀm
 *
¥ob
, *
C
);

195 ~
l2r_l2_svc_fun
();

197 
fun
(*
w
);

198 
gød
(*
w
, *
g
);

199 
Hv
(*
s
, *
Hs
);

201 
gë_ƒ_v¨übÀ
();

203 
	m¥Ÿe˘ed
:

204 
Xv
(*
v
, *Xv);

205 
subXv
(*
v
, *
Xv
);

206 
subXTv
(*
v
, *
XTv
);

208 *
	mC
;

209 *
	mz
;

210 *
	mD
;

211 *
	mI
;

212 
	msizeI
;

213 c⁄° 
¥obÀm
 *
	m¥ob
;

216 
	gl2r_l2_svc_fun
::
	$l2r_l2_svc_fun
(c⁄° 
¥obÀm
 *
¥ob
, *
C
)

218 
l
=
¥ob
->l;

220 
this
->
¥ob
 =Örob;

222 
z
 = 
√w
 [
l
];

223 
D
 = 
√w
 [
l
];

224 
I
 = 
√w
 [
l
];

225 
this
->
C
 = C;

226 
	}
}

228 
	gl2r_l2_svc_fun
::~
	$l2r_l2_svc_fun
()

230 
dñëe
[] 
z
;

231 
dñëe
[] 
D
;

232 
dñëe
[] 
I
;

233 
	}
}

235 
	gl2r_l2_svc_fun
::
	$fun
(*
w
)

237 
i
;

238 
f
=0;

239 *
y
=
¥ob
->y;

240 
l
=
¥ob
->l;

241 
w_size
=
	`gë_ƒ_v¨übÀ
();

243 
	`Xv
(
w
, 
z
);

245 
i
=0;i<
w_size
;i++)

246 
f
 +
w
[
i
]*w[i];

247 
f
 /= 2.0;

248 
i
=0;i<
l
;i++)

250 
z
[
i
] = 
y
[i]*z[i];

251 
d
 = 1-
z
[
i
];

252 i‡(
d
 > 0)

253 
f
 +
C
[
i
]*
d
*d;

256 (
f
);

257 
	}
}

259 
	gl2r_l2_svc_fun
::
	$gød
(*
w
, *
g
)

261 
i
;

262 *
y
=
¥ob
->y;

263 
l
=
¥ob
->l;

264 
w_size
=
	`gë_ƒ_v¨übÀ
();

266 
sizeI
 = 0;

267 
i
=0;i<
l
;i++)

268 i‡(
z
[
i
] < 1)

270 
z
[
sizeI
] = 
C
[
i
]*
y
[i]*(z[i]-1);

271 
I
[
sizeI
] = 
i
;

272 
sizeI
++;

274 
	`subXTv
(
z
, 
g
);

276 
i
=0;i<
w_size
;i++)

277 
g
[
i
] = 
w
[i] + 2*g[i];

278 
	}
}

280 
	gl2r_l2_svc_fun
::
	$gë_ƒ_v¨übÀ
()

282  
¥ob
->
n
;

283 
	}
}

285 
	gl2r_l2_svc_fun
::
	$Hv
(*
s
, *
Hs
)

287 
i
;

288 
w_size
=
	`gë_ƒ_v¨übÀ
();

289 *
wa
 = 
√w
 [
sizeI
];

291 
	`subXv
(
s
, 
wa
);

292 
i
=0;i<
sizeI
;i++)

293 
wa
[
i
] = 
C
[
I
[i]]*wa[i];

295 
	`subXTv
(
wa
, 
Hs
);

296 
i
=0;i<
w_size
;i++)

297 
Hs
[
i
] = 
s
[i] + 2*Hs[i];

298 
dñëe
[] 
wa
;

299 
	}
}

301 
	gl2r_l2_svc_fun
::
	$Xv
(*
v
, *
Xv
)

303 
i
;

304 
l
=
¥ob
->l;

305 
„©uª_node
 **
x
=
¥ob
->x;

307 
i
=0;i<
l
;i++)

309 
„©uª_node
 *
s
=
x
[
i
];

310 
Xv
[
i
]=0;

311 
s
->
ödex
!=-1)

313 
Xv
[
i
]+=
v
[
s
->
ödex
-1]*s->
vÆue
;

314 
s
++;

317 
	}
}

319 
	gl2r_l2_svc_fun
::
	$subXv
(*
v
, *
Xv
)

321 
i
;

322 
„©uª_node
 **
x
=
¥ob
->x;

324 
i
=0;i<
sizeI
;i++)

326 
„©uª_node
 *
s
=
x
[
I
[
i
]];

327 
Xv
[
i
]=0;

328 
s
->
ödex
!=-1)

330 
Xv
[
i
]+=
v
[
s
->
ödex
-1]*s->
vÆue
;

331 
s
++;

334 
	}
}

336 
	gl2r_l2_svc_fun
::
	$subXTv
(*
v
, *
XTv
)

338 
i
;

339 
w_size
=
	`gë_ƒ_v¨übÀ
();

340 
„©uª_node
 **
x
=
¥ob
->x;

342 
i
=0;i<
w_size
;i++)

343 
XTv
[
i
]=0;

344 
i
=0;i<
sizeI
;i++)

346 
„©uª_node
 *
s
=
x
[
I
[
i
]];

347 
s
->
ödex
!=-1)

349 
XTv
[
s
->
ödex
-1]+=
v
[
i
]*s->
vÆue
;

350 
s
++;

353 
	}
}

355 ˛as†
	cl2r_l2_svr_fun
: 
public
 
l2r_l2_svc_fun


357 
public
:

358 
l2r_l2_svr_fun
(c⁄° 
¥obÀm
 *
¥ob
, *
C
, 
p
);

360 
fun
(*
w
);

361 
gød
(*
w
, *
g
);

363 
	m¥iv©e
:

364 
p
;

367 
	gl2r_l2_svr_fun
::
	$l2r_l2_svr_fun
(c⁄° 
¥obÀm
 *
¥ob
, *
C
, 
p
):

368 
	$l2r_l2_svc_fun
(
¥ob
, 
C
)

370 
this
->
p
 =Ö;

371 
	}
}

373 
	gl2r_l2_svr_fun
::
	$fun
(*
w
)

375 
i
;

376 
f
=0;

377 *
y
=
¥ob
->y;

378 
l
=
¥ob
->l;

379 
w_size
=
	`gë_ƒ_v¨übÀ
();

380 
d
;

382 
	`Xv
(
w
, 
z
);

384 
i
=0;i<
w_size
;i++)

385 
f
 +
w
[
i
]*w[i];

386 
f
 /= 2;

387 
i
=0;i<
l
;i++)

389 
d
 = 
z
[
i
] - 
y
[i];

390 if(
d
 < -
p
)

391 
f
 +
C
[
i
]*(
d
+
p
)*(d+p);

392 if(
d
 > 
p
)

393 
f
 +
C
[
i
]*(
d
-
p
)*(d-p);

396 (
f
);

397 
	}
}

399 
	gl2r_l2_svr_fun
::
	$gød
(*
w
, *
g
)

401 
i
;

402 *
y
=
¥ob
->y;

403 
l
=
¥ob
->l;

404 
w_size
=
	`gë_ƒ_v¨übÀ
();

405 
d
;

407 
sizeI
 = 0;

408 
i
=0;i<
l
;i++)

410 
d
 = 
z
[
i
] - 
y
[i];

413 if(
d
 < -
p
)

415 
z
[
sizeI
] = 
C
[
i
]*(
d
+
p
);

416 
I
[
sizeI
] = 
i
;

417 
sizeI
++;

419 if(
d
 > 
p
)

421 
z
[
sizeI
] = 
C
[
i
]*(
d
-
p
);

422 
I
[
sizeI
] = 
i
;

423 
sizeI
++;

427 
	`subXTv
(
z
, 
g
);

429 
i
=0;i<
w_size
;i++)

430 
g
[
i
] = 
w
[i] + 2*g[i];

431 
	}
}

453 
	#GETI
(
i
Ë((Ë
¥ob
->
y
[i])

	)

456 ˛as†
	cSﬁvî_MCSVM_CS


458 
	mpublic
:

459 
Sﬁvî_MCSVM_CS
(c⁄° 
¥obÀm
 *
¥ob
, 
ƒ_˛ass
, *
C
, 
ïs
=0.1, 
max_ôî
=100000);

460 ~
Sﬁvî_MCSVM_CS
();

461 
Sﬁve
(*
w
);

462 
	m¥iv©e
:

463 
sﬁve_sub_¥obÀm
(
A_i
, 
yi
, 
C_yi
, 
a˘ive_i
, *
Æpha_√w
);

464 
boﬁ
 
be_shrunk
(
i
, 
m
, 
yi
, 
Æpha_i
, 
möG
);

465 *
	mB
, *
	mC
, *
	mG
;

466 
	mw_size
, 
	ml
;

467 
	mƒ_˛ass
;

468 
	mmax_ôî
;

469 
	mïs
;

470 c⁄° 
¥obÀm
 *
	m¥ob
;

473 
	gSﬁvî_MCSVM_CS
::
	$Sﬁvî_MCSVM_CS
(c⁄° 
¥obÀm
 *
¥ob
, 
ƒ_˛ass
, *
weighãd_C
, 
ïs
, 
max_ôî
)

475 
this
->
w_size
 = 
¥ob
->
n
;

476 
this
->
l
 = 
¥ob
->l;

477 
this
->
ƒ_˛ass
 =Çr_class;

478 
this
->
ïs
 =Éps;

479 
this
->
max_ôî
 = max_iter;

480 
this
->
¥ob
 =Örob;

481 
this
->
B
 = 
√w
 [
ƒ_˛ass
];

482 
this
->
G
 = 
√w
 [
ƒ_˛ass
];

483 
this
->
C
 = 
weighãd_C
;

484 
	}
}

486 
	gSﬁvî_MCSVM_CS
::~
	$Sﬁvî_MCSVM_CS
()

488 
dñëe
[] 
B
;

489 
dñëe
[] 
G
;

490 
	}
}

492 
	$com∑ª_doubÀ
(c⁄° *
a
, c⁄° *
b
)

494 if(*(*)
a
 > *(*)
b
)

496 if(*(*)
a
 < *(*)
b
)

499 
	}
}

501 
	gSﬁvî_MCSVM_CS
::
	$sﬁve_sub_¥obÀm
(
A_i
, 
yi
, 
C_yi
, 
a˘ive_i
, *
Æpha_√w
)

503 
r
;

504 *
D
;

506 
	`˛⁄e
(
D
, 
B
, 
a˘ive_i
);

507 if(
yi
 < 
a˘ive_i
)

508 
D
[
yi
] +
A_i
*
C_yi
;

509 
	`qs‹t
(
D
, 
a˘ive_i
, (), 
com∑ª_doubÀ
);

511 
bëa
 = 
D
[0] - 
A_i
*
C_yi
;

512 
r
=1;r<
a˘ive_i
 && 
bëa
<r*
D
[r];r++)

513 
bëa
 +
D
[
r
];

514 
bëa
 /
r
;

516 
r
=0;r<
a˘ive_i
;r++)

518 if(
r
 =
yi
)

519 
Æpha_√w
[
r
] = 
	`mö
(
C_yi
, (
bëa
-
B
[r])/
A_i
);

521 
Æpha_√w
[
r
] = 
	`mö
(()0, (
bëa
 - 
B
[r])/
A_i
);

523 
dñëe
[] 
D
;

524 
	}
}

526 
boﬁ
 
	gSﬁvî_MCSVM_CS
::
	$be_shrunk
(
i
, 
m
, 
yi
, 
Æpha_i
, 
möG
)

528 
bound
 = 0;

529 if(
m
 =
yi
)

530 
bound
 = 
C
[
	`GETI
(
i
)];

531 if(
Æpha_i
 =
bound
 && 
G
[
m
] < 
möG
)

532  
åue
;

533  
Ál£
;

534 
	}
}

536 
	gSﬁvî_MCSVM_CS
::
	$Sﬁve
(*
w
)

538 
i
, 
m
, 
s
;

539 
ôî
 = 0;

540 *
Æpha
 = 
√w
 [
l
*
ƒ_˛ass
];

541 *
Æpha_√w
 = 
√w
 [
ƒ_˛ass
];

542 *
ödex
 = 
√w
 [
l
];

543 *
QD
 = 
√w
 [
l
];

544 *
d_öd
 = 
√w
 [
ƒ_˛ass
];

545 *
d_vÆ
 = 
√w
 [
ƒ_˛ass
];

546 *
Æpha_ödex
 = 
√w
 [
ƒ_˛ass
*
l
];

547 *
y_ödex
 = 
√w
 [
l
];

548 
a˘ive_size
 = 
l
;

549 *
a˘ive_size_i
 = 
√w
 [
l
];

550 
ïs_shrök
 = 
	`max
(10.0*
ïs
, 1.0);

551 
boﬁ
 
°¨t_‰om_Æl
 = 
åue
;

558 
i
=0;i<
l
*
ƒ_˛ass
;i++)

559 
Æpha
[
i
] = 0;

561 
i
=0;i<
w_size
*
ƒ_˛ass
;i++)

562 
w
[
i
] = 0;

563 
i
=0;i<
l
;i++)

565 
m
=0;m<
ƒ_˛ass
;m++)

566 
Æpha_ödex
[
i
*
ƒ_˛ass
+
m
] = m;

567 
„©uª_node
 *
xi
 = 
¥ob
->
x
[
i
];

568 
QD
[
i
] = 0;

569 
xi
->
ödex
 != -1)

571 
vÆ
 = 
xi
->
vÆue
;

572 
QD
[
i
] +
vÆ
*val;

577 
xi
++;

579 
a˘ive_size_i
[
i
] = 
ƒ_˛ass
;

580 
y_ödex
[
i
] = ()
¥ob
->
y
[i];

581 
ödex
[
i
] = i;

584 
ôî
 < 
max_ôî
)

586 
°›pög
 = -
INF
;

587 
i
=0;i<
a˘ive_size
;i++)

589 
j
 = 
i
+
	`ønd
()%(
a˘ive_size
-i);

590 
	`sw≠
(
ödex
[
i
], index[
j
]);

592 
s
=0;s<
a˘ive_size
;s++)

594 
i
 = 
ödex
[
s
];

595 
Ai
 = 
QD
[
i
];

596 *
Æpha_i
 = &
Æpha
[
i
*
ƒ_˛ass
];

597 *
Æpha_ödex_i
 = &
Æpha_ödex
[
i
*
ƒ_˛ass
];

599 if(
Ai
 > 0)

601 
m
=0;m<
a˘ive_size_i
[
i
];m++)

602 
G
[
m
] = 1;

603 if(
y_ödex
[
i
] < 
a˘ive_size_i
[i])

604 
G
[
y_ödex
[
i
]] = 0;

606 
„©uª_node
 *
xi
 = 
¥ob
->
x
[
i
];

607 
xi
->
ödex
!= -1)

609 *
w_i
 = &
w
[(
xi
->
ödex
-1)*
ƒ_˛ass
];

610 
m
=0;m<
a˘ive_size_i
[
i
];m++)

611 
G
[
m
] +
w_i
[
Æpha_ödex_i
[m]]*(
xi
->
vÆue
);

612 
xi
++;

615 
möG
 = 
INF
;

616 
maxG
 = -
INF
;

617 
m
=0;m<
a˘ive_size_i
[
i
];m++)

619 if(
Æpha_i
[
Æpha_ödex_i
[
m
]] < 0 && 
G
[m] < 
möG
)

620 
möG
 = 
G
[
m
];

621 if(
G
[
m
] > 
maxG
)

622 
maxG
 = 
G
[
m
];

624 if(
y_ödex
[
i
] < 
a˘ive_size_i
[i])

625 if(
Æpha_i
[(Ë
¥ob
->
y
[
i
]] < 
C
[
	`GETI
(i)] && 
G
[
y_ödex
[i]] < 
möG
)

626 
möG
 = 
G
[
y_ödex
[
i
]];

628 
m
=0;m<
a˘ive_size_i
[
i
];m++)

630 if(
	`be_shrunk
(
i
, 
m
, 
y_ödex
[i], 
Æpha_i
[
Æpha_ödex_i
[m]], 
möG
))

632 
a˘ive_size_i
[
i
]--;

633 
a˘ive_size_i
[
i
]>
m
)

635 if(!
	`be_shrunk
(
i
, 
a˘ive_size_i
[i], 
y_ödex
[i],

636 
Æpha_i
[
Æpha_ödex_i
[
a˘ive_size_i
[
i
]]], 
möG
))

638 
	`sw≠
(
Æpha_ödex_i
[
m
],áÕha_ödex_i[
a˘ive_size_i
[
i
]]);

639 
	`sw≠
(
G
[
m
], G[
a˘ive_size_i
[
i
]]);

640 if(
y_ödex
[
i
] =
a˘ive_size_i
[i])

641 
y_ödex
[
i
] = 
m
;

642 if(
y_ödex
[
i
] =
m
)

643 
y_ödex
[
i
] = 
a˘ive_size_i
[i];

646 
a˘ive_size_i
[
i
]--;

651 if(
a˘ive_size_i
[
i
] <= 1)

653 
a˘ive_size
--;

654 
	`sw≠
(
ödex
[
s
], index[
a˘ive_size
]);

655 
s
--;

659 if(
maxG
-
möG
 <= 1e-12)

662 
°›pög
 = 
	`max
(
maxG
 - 
möG
, stopping);

664 
m
=0;m<
a˘ive_size_i
[
i
];m++)

665 
B
[
m
] = 
G
[m] - 
Ai
*
Æpha_i
[
Æpha_ödex_i
[m]] ;

667 
	`sﬁve_sub_¥obÀm
(
Ai
, 
y_ödex
[
i
], 
C
[
	`GETI
(i)], 
a˘ive_size_i
[i], 
Æpha_√w
);

668 
nz_d
 = 0;

669 
m
=0;m<
a˘ive_size_i
[
i
];m++)

671 
d
 = 
Æpha_√w
[
m
] - 
Æpha_i
[
Æpha_ödex_i
[m]];

672 
Æpha_i
[
Æpha_ödex_i
[
m
]] = 
Æpha_√w
[m];

673 if(
	`Ábs
(
d
) >= 1e-12)

675 
d_öd
[
nz_d
] = 
Æpha_ödex_i
[
m
];

676 
d_vÆ
[
nz_d
] = 
d
;

677 
nz_d
++;

681 
xi
 = 
¥ob
->
x
[
i
];

682 
xi
->
ödex
 != -1)

684 *
w_i
 = &
w
[(
xi
->
ödex
-1)*
ƒ_˛ass
];

685 
m
=0;m<
nz_d
;m++)

686 
w_i
[
d_öd
[
m
]] +
d_vÆ
[m]*
xi
->
vÆue
;

687 
xi
++;

692 
ôî
++;

693 if(
ôî
 % 10 == 0)

695 
	`öfo
(".");

698 if(
°›pög
 < 
ïs_shrök
)

700 if(
°›pög
 < 
ïs
 && 
°¨t_‰om_Æl
 =
åue
)

704 
a˘ive_size
 = 
l
;

705 
i
=0;i<
l
;i++)

706 
a˘ive_size_i
[
i
] = 
ƒ_˛ass
;

707 
	`öfo
("*");

708 
ïs_shrök
 = 
	`max
”ps_shrök/2, 
ïs
);

709 
°¨t_‰om_Æl
 = 
åue
;

713 
°¨t_‰om_Æl
 = 
Ál£
;

716 
	`öfo
("\n›timiz©i⁄ föished, #ôî = %d\n",
ôî
);

717 i‡(
ôî
 >
max_ôî
)

718 
	`öfo
("\nWARNING:Ñeaching maxÇumber of iterations\n");

721 
v
 = 0;

722 
nSV
 = 0;

723 
i
=0;i<
w_size
*
ƒ_˛ass
;i++)

724 
v
 +
w
[
i
]*w[i];

725 
v
 = 0.5*v;

726 
i
=0;i<
l
*
ƒ_˛ass
;i++)

728 
v
 +
Æpha
[
i
];

729 if(
	`Ábs
(
Æpha
[
i
]) > 0)

730 
nSV
++;

732 
i
=0;i<
l
;i++)

733 
v
 -
Æpha
[
i
*
ƒ_˛ass
+()
¥ob
->
y
[i]];

734 
	`öfo
("Obje˘ivêvÆuê%lf\n",
v
);

735 
	`öfo
("nSV = %d\n",
nSV
);

737 
dñëe
 [] 
Æpha
;

738 
dñëe
 [] 
Æpha_√w
;

739 
dñëe
 [] 
ödex
;

740 
dñëe
 [] 
QD
;

741 
dñëe
 [] 
d_öd
;

742 
dñëe
 [] 
d_vÆ
;

743 
dñëe
 [] 
Æpha_ödex
;

744 
dñëe
 [] 
y_ödex
;

745 
dñëe
 [] 
a˘ive_size_i
;

746 
	}
}

774 #unde‡
GETI


775 
	#GETI
(
i
Ë(
y
[i]+1)

	)

778 
	$sﬁve_l2r_l1l2_svc
(

779 c⁄° 
¥obÀm
 *
¥ob
, *
w
, 
ïs
,

780 
Cp
, 
Cn
, 
sﬁvî_ty≥
)

782 
l
 = 
¥ob
->l;

783 
w_size
 = 
¥ob
->
n
;

784 
i
, 
s
, 
ôî
 = 0;

785 
C
, 
d
, 
G
;

786 *
QD
 = 
√w
 [
l
];

787 
max_ôî
 = 1000;

788 *
ödex
 = 
√w
 [
l
];

789 *
Æpha
 = 
√w
 [
l
];

790 
sch¨
 *
y
 = 
√w
 sch¨[
l
];

791 
a˘ive_size
 = 
l
;

794 
PG
;

795 
PGmax_ﬁd
 = 
INF
;

796 
PGmö_ﬁd
 = -
INF
;

797 
PGmax_√w
, 
PGmö_√w
;

800 
düg
[3] = {0.5/
Cn
, 0, 0.5/
Cp
};

801 
uµî_bound
[3] = {
INF
, 0, INF};

802 if(
sﬁvî_ty≥
 =
L2R_L1LOSS_SVC_DUAL
)

804 
düg
[0] = 0;

805 
düg
[2] = 0;

806 
uµî_bound
[0] = 
Cn
;

807 
uµî_bound
[2] = 
Cp
;

810 
i
=0; i<
l
; i++)

812 if(
¥ob
->
y
[
i
] > 0)

814 
y
[
i
] = +1;

818 
y
[
i
] = -1;

824 
i
=0; i<
l
; i++)

825 
Æpha
[
i
] = 0;

827 
i
=0; i<
w_size
; i++)

828 
w
[
i
] = 0;

829 
i
=0; i<
l
; i++)

831 
QD
[
i
] = 
düg
[
	`GETI
(i)];

833 
„©uª_node
 *
xi
 = 
¥ob
->
x
[
i
];

834 
xi
->
ödex
 != -1)

836 
vÆ
 = 
xi
->
vÆue
;

837 
QD
[
i
] +
vÆ
*val;

838 
w
[
xi
->
ödex
-1] +
y
[
i
]*
Æpha
[i]*
vÆ
;

839 
xi
++;

841 
ödex
[
i
] = i;

844 
ôî
 < 
max_ôî
)

846 
PGmax_√w
 = -
INF
;

847 
PGmö_√w
 = 
INF
;

849 
i
=0; i<
a˘ive_size
; i++)

851 
j
 = 
i
+
	`ønd
()%(
a˘ive_size
-i);

852 
	`sw≠
(
ödex
[
i
], index[
j
]);

855 
s
=0; s<
a˘ive_size
; s++)

857 
i
 = 
ödex
[
s
];

858 
G
 = 0;

859 
sch¨
 
yi
 = 
y
[
i
];

861 
„©uª_node
 *
xi
 = 
¥ob
->
x
[
i
];

862 
xi
->
ödex
!= -1)

864 
G
 +
w
[
xi
->
ödex
-1]*(xi->
vÆue
);

865 
xi
++;

867 
G
 = G*
yi
-1;

869 
C
 = 
uµî_bound
[
	`GETI
(
i
)];

870 
G
 +
Æpha
[
i
]*
düg
[
	`GETI
(i)];

872 
PG
 = 0;

873 i‡(
Æpha
[
i
] == 0)

875 i‡(
G
 > 
PGmax_ﬁd
)

877 
a˘ive_size
--;

878 
	`sw≠
(
ödex
[
s
], index[
a˘ive_size
]);

879 
s
--;

882 i‡(
G
 < 0)

883 
PG
 = 
G
;

885 i‡(
Æpha
[
i
] =
C
)

887 i‡(
G
 < 
PGmö_ﬁd
)

889 
a˘ive_size
--;

890 
	`sw≠
(
ödex
[
s
], index[
a˘ive_size
]);

891 
s
--;

894 i‡(
G
 > 0)

895 
PG
 = 
G
;

898 
PG
 = 
G
;

900 
PGmax_√w
 = 
	`max
(PGmax_√w, 
PG
);

901 
PGmö_√w
 = 
	`mö
(PGmö_√w, 
PG
);

903 if(
	`Ábs
(
PG
) > 1.0e-12)

905 
Æpha_ﬁd
 = 
Æpha
[
i
];

906 
Æpha
[
i
] = 
	`mö
(
	`max
◊Õha[i] - 
G
/
QD
[i], 0.0), 
C
);

907 
d
 = (
Æpha
[
i
] - 
Æpha_ﬁd
)*
yi
;

908 
xi
 = 
¥ob
->
x
[
i
];

909 
xi
->
ödex
 != -1)

911 
w
[
xi
->
ödex
-1] +
d
*xi->
vÆue
;

912 
xi
++;

917 
ôî
++;

918 if(
ôî
 % 10 == 0)

919 
	`öfo
(".");

921 if(
PGmax_√w
 - 
PGmö_√w
 <
ïs
)

923 if(
a˘ive_size
 =
l
)

927 
a˘ive_size
 = 
l
;

928 
	`öfo
("*");

929 
PGmax_ﬁd
 = 
INF
;

930 
PGmö_ﬁd
 = -
INF
;

934 
PGmax_ﬁd
 = 
PGmax_√w
;

935 
PGmö_ﬁd
 = 
PGmö_√w
;

936 i‡(
PGmax_ﬁd
 <= 0)

937 
PGmax_ﬁd
 = 
INF
;

938 i‡(
PGmö_ﬁd
 >= 0)

939 
PGmö_ﬁd
 = -
INF
;

942 
	`öfo
("\n›timiz©i⁄ föished, #ôî = %d\n",
ôî
);

943 i‡(
ôî
 >
max_ôî
)

944 
	`öfo
("\nWARNING:Ñeaching maxÇumber of iterations\nUsing -s 2 may be faster (also see FAQ)\n\n");

948 
v
 = 0;

949 
nSV
 = 0;

950 
i
=0; i<
w_size
; i++)

951 
v
 +
w
[
i
]*w[i];

952 
i
=0; i<
l
; i++)

954 
v
 +
Æpha
[
i
]*◊Õha[i]*
düg
[
	`GETI
(i)] - 2);

955 if(
Æpha
[
i
] > 0)

956 ++
nSV
;

958 
	`öfo
("Obje˘ivêvÆuê%lf\n",
v
/2);

959 
	`öfo
("nSV = %d\n",
nSV
);

961 
dñëe
 [] 
QD
;

962 
dñëe
 [] 
Æpha
;

963 
dñëe
 [] 
y
;

964 
dñëe
 [] 
ödex
;

965 
	}
}

992 #unde‡
GETI


993 
	#GETI
(
i
Ë(0)

	)

996 
	$sﬁve_l2r_l1l2_svr
(

997 c⁄° 
¥obÀm
 *
¥ob
, *
w
, c⁄° 
∑ømëî
 *
∑øm
,

998 
sﬁvî_ty≥
)

1000 
l
 = 
¥ob
->l;

1001 
C
 = 
∑øm
->C;

1002 
p
 = 
∑øm
->p;

1003 
w_size
 = 
¥ob
->
n
;

1004 
ïs
 = 
∑øm
->eps;

1005 
i
, 
s
, 
ôî
 = 0;

1006 
max_ôî
 = 1000;

1007 
a˘ive_size
 = 
l
;

1008 *
ödex
 = 
√w
 [
l
];

1010 
d
, 
G
, 
H
;

1011 
Gmax_ﬁd
 = 
INF
;

1012 
Gmax_√w
, 
Gn‹m1_√w
;

1013 
Gn‹m1_öô
 = -1.0;

1014 *
bëa
 = 
√w
 [
l
];

1015 *
QD
 = 
√w
 [
l
];

1016 *
y
 = 
¥ob
->y;

1019 
œmbda
[1], 
uµî_bound
[1];

1020 
œmbda
[0] = 0.5/
C
;

1021 
uµî_bound
[0] = 
INF
;

1023 if(
sﬁvî_ty≥
 =
L2R_L1LOSS_SVR_DUAL
)

1025 
œmbda
[0] = 0;

1026 
uµî_bound
[0] = 
C
;

1031 
i
=0; i<
l
; i++)

1032 
bëa
[
i
] = 0;

1034 
i
=0; i<
w_size
; i++)

1035 
w
[
i
] = 0;

1036 
i
=0; i<
l
; i++)

1038 
QD
[
i
] = 0;

1039 
„©uª_node
 *
xi
 = 
¥ob
->
x
[
i
];

1040 
xi
->
ödex
 != -1)

1042 
vÆ
 = 
xi
->
vÆue
;

1043 
QD
[
i
] +
vÆ
*val;

1044 
w
[
xi
->
ödex
-1] +
bëa
[
i
]*
vÆ
;

1045 
xi
++;

1048 
ödex
[
i
] = i;

1052 
ôî
 < 
max_ôî
)

1054 
Gmax_√w
 = 0;

1055 
Gn‹m1_√w
 = 0;

1057 
i
=0; i<
a˘ive_size
; i++)

1059 
j
 = 
i
+
	`ønd
()%(
a˘ive_size
-i);

1060 
	`sw≠
(
ödex
[
i
], index[
j
]);

1063 
s
=0; s<
a˘ive_size
; s++)

1065 
i
 = 
ödex
[
s
];

1066 
G
 = -
y
[
i
] + 
œmbda
[
	`GETI
(i)]*
bëa
[i];

1067 
H
 = 
QD
[
i
] + 
œmbda
[
	`GETI
(i)];

1069 
„©uª_node
 *
xi
 = 
¥ob
->
x
[
i
];

1070 
xi
->
ödex
 != -1)

1072 
öd
 = 
xi
->
ödex
-1;

1073 
vÆ
 = 
xi
->
vÆue
;

1074 
G
 +
vÆ
*
w
[
öd
];

1075 
xi
++;

1078 
Gp
 = 
G
+
p
;

1079 
Gn
 = 
G
-
p
;

1080 
viﬁ©i⁄
 = 0;

1081 if(
bëa
[
i
] == 0)

1083 if(
Gp
 < 0)

1084 
viﬁ©i⁄
 = -
Gp
;

1085 if(
Gn
 > 0)

1086 
viﬁ©i⁄
 = 
Gn
;

1087 if(
Gp
>
Gmax_ﬁd
 && 
Gn
<-Gmax_old)

1089 
a˘ive_size
--;

1090 
	`sw≠
(
ödex
[
s
], index[
a˘ive_size
]);

1091 
s
--;

1095 if(
bëa
[
i
] >
uµî_bound
[
	`GETI
(i)])

1097 if(
Gp
 > 0)

1098 
viﬁ©i⁄
 = 
Gp
;

1099 if(
Gp
 < -
Gmax_ﬁd
)

1101 
a˘ive_size
--;

1102 
	`sw≠
(
ödex
[
s
], index[
a˘ive_size
]);

1103 
s
--;

1107 if(
bëa
[
i
] <-
uµî_bound
[
	`GETI
(i)])

1109 if(
Gn
 < 0)

1110 
viﬁ©i⁄
 = -
Gn
;

1111 if(
Gn
 > 
Gmax_ﬁd
)

1113 
a˘ive_size
--;

1114 
	`sw≠
(
ödex
[
s
], index[
a˘ive_size
]);

1115 
s
--;

1119 if(
bëa
[
i
] > 0)

1120 
viﬁ©i⁄
 = 
	`Ábs
(
Gp
);

1122 
viﬁ©i⁄
 = 
	`Ábs
(
Gn
);

1124 
Gmax_√w
 = 
	`max
(Gmax_√w, 
viﬁ©i⁄
);

1125 
Gn‹m1_√w
 +
viﬁ©i⁄
;

1128 if(
Gp
 < 
H
*
bëa
[
i
])

1129 
d
 = -
Gp
/
H
;

1130 if(
Gn
 > 
H
*
bëa
[
i
])

1131 
d
 = -
Gn
/
H
;

1133 
d
 = -
bëa
[
i
];

1135 if(
	`Ábs
(
d
) < 1.0e-12)

1138 
bëa_ﬁd
 = 
bëa
[
i
];

1139 
bëa
[
i
] = 
	`mö
(
	`max
(bëa[i]+
d
, -
uµî_bound
[
	`GETI
(i)]), upper_bound[GETI(i)]);

1140 
d
 = 
bëa
[
i
]-
bëa_ﬁd
;

1142 if(
d
 != 0)

1144 
xi
 = 
¥ob
->
x
[
i
];

1145 
xi
->
ödex
 != -1)

1147 
w
[
xi
->
ödex
-1] +
d
*xi->
vÆue
;

1148 
xi
++;

1153 if(
ôî
 == 0)

1154 
Gn‹m1_öô
 = 
Gn‹m1_√w
;

1155 
ôî
++;

1156 if(
ôî
 % 10 == 0)

1157 
	`öfo
(".");

1159 if(
Gn‹m1_√w
 <
ïs
*
Gn‹m1_öô
)

1161 if(
a˘ive_size
 =
l
)

1165 
a˘ive_size
 = 
l
;

1166 
	`öfo
("*");

1167 
Gmax_ﬁd
 = 
INF
;

1172 
Gmax_ﬁd
 = 
Gmax_√w
;

1175 
	`öfo
("\n›timiz©i⁄ föished, #ôî = %d\n", 
ôî
);

1176 if(
ôî
 >
max_ôî
)

1177 
	`öfo
("\nWARNING:Ñeaching maxÇumber of iterations\nUsing -s 11 may be faster\n\n");

1180 
v
 = 0;

1181 
nSV
 = 0;

1182 
i
=0; i<
w_size
; i++)

1183 
v
 +
w
[
i
]*w[i];

1184 
v
 = 0.5*v;

1185 
i
=0; i<
l
; i++)

1187 
v
 +
p
*
	`Ábs
(
bëa
[
i
]Ë- 
y
[i]*bëa[i] + 0.5*
œmbda
[
	`GETI
(i)]*beta[i]*beta[i];

1188 if(
bëa
[
i
] != 0)

1189 
nSV
++;

1192 
	`öfo
("Obje˘ivêvÆuê%lf\n", 
v
);

1193 
	`öfo
("nSV = %d\n",
nSV
);

1195 
dñëe
 [] 
bëa
;

1196 
dñëe
 [] 
QD
;

1197 
dñëe
 [] 
ödex
;

1198 
	}
}

1219 #unde‡
GETI


1220 
	#GETI
(
i
Ë(
y
[i]+1)

	)

1223 
	$sﬁve_l2r_Ã_duÆ
(c⁄° 
¥obÀm
 *
¥ob
, *
w
, 
ïs
, 
Cp
, 
Cn
)

1225 
l
 = 
¥ob
->l;

1226 
w_size
 = 
¥ob
->
n
;

1227 
i
, 
s
, 
ôî
 = 0;

1228 *
xTx
 = 
√w
 [
l
];

1229 
max_ôî
 = 1000;

1230 *
ödex
 = 
√w
 [
l
];

1231 *
Æpha
 = 
√w
 [2*
l
];

1232 
sch¨
 *
y
 = 
√w
 sch¨[
l
];

1233 
max_ö√r_ôî
 = 100;

1234 
ö√ªps
 = 1e-2;

1235 
ö√ªps_mö
 = 
	`mö
(1e-8, 
ïs
);

1236 
uµî_bound
[3] = {
Cn
, 0, 
Cp
};

1238 
i
=0; i<
l
; i++)

1240 if(
¥ob
->
y
[
i
] > 0)

1242 
y
[
i
] = +1;

1246 
y
[
i
] = -1;

1253 
i
=0; i<
l
; i++)

1255 
Æpha
[2*
i
] = 
	`mö
(0.001*
uµî_bound
[
	`GETI
(i)], 1e-8);

1256 
Æpha
[2*
i
+1] = 
uµî_bound
[
	`GETI
(i)] -álpha[2*i];

1259 
i
=0; i<
w_size
; i++)

1260 
w
[
i
] = 0;

1261 
i
=0; i<
l
; i++)

1263 
xTx
[
i
] = 0;

1264 
„©uª_node
 *
xi
 = 
¥ob
->
x
[
i
];

1265 
xi
->
ödex
 != -1)

1267 
vÆ
 = 
xi
->
vÆue
;

1268 
xTx
[
i
] +
vÆ
*val;

1269 
w
[
xi
->
ödex
-1] +
y
[
i
]*
Æpha
[2*i]*
vÆ
;

1270 
xi
++;

1272 
ödex
[
i
] = i;

1275 
ôî
 < 
max_ôî
)

1277 
i
=0; i<
l
; i++)

1279 
j
 = 
i
+
	`ønd
()%(
l
-i);

1280 
	`sw≠
(
ödex
[
i
], index[
j
]);

1282 
√wt⁄_ôî
 = 0;

1283 
Gmax
 = 0;

1284 
s
=0; s<
l
; s++)

1286 
i
 = 
ödex
[
s
];

1287 
sch¨
 
yi
 = 
y
[
i
];

1288 
C
 = 
uµî_bound
[
	`GETI
(
i
)];

1289 
ywTx
 = 0, 
xisq
 = 
xTx
[
i
];

1290 
„©uª_node
 *
xi
 = 
¥ob
->
x
[
i
];

1291 
xi
->
ödex
 != -1)

1293 
ywTx
 +
w
[
xi
->
ödex
-1]*xi->
vÆue
;

1294 
xi
++;

1296 
ywTx
 *
y
[
i
];

1297 
a
 = 
xisq
, 
b
 = 
ywTx
;

1300 
öd1
 = 2*
i
, 
öd2
 = 2*i+1, 
sign
 = 1;

1301 if(0.5*
a
*(
Æpha
[
öd2
]-Æpha[
öd1
])+
b
 < 0)

1303 
öd1
 = 2*
i
+1;

1304 
öd2
 = 2*
i
;

1305 
sign
 = -1;

1309 
Æpha_ﬁd
 = 
Æpha
[
öd1
];

1310 
z
 = 
Æpha_ﬁd
;

1311 if(
C
 - 
z
 < 0.5 * C)

1312 
z
 = 0.1*z;

1313 
gp
 = 
a
*(
z
-
Æpha_ﬁd
)+
sign
*
b
+
	`log
(z/(
C
-z));

1314 
Gmax
 = 
	`max
(Gmax, 
	`Ábs
(
gp
));

1317 c⁄° 
ëa
 = 0.1;

1318 
ö√r_ôî
 = 0;

1319 
ö√r_ôî
 <
max_ö√r_ôî
)

1321 if(
	`Ábs
(
gp
Ë< 
ö√ªps
)

1323 
gµ
 = 
a
 + 
C
/(C-
z
)/z;

1324 
tmpz
 = 
z
 - 
gp
/
gµ
;

1325 if(
tmpz
 <= 0)

1326 
z
 *
ëa
;

1328 
z
 = 
tmpz
;

1329 
gp
 = 
a
*(
z
-
Æpha_ﬁd
)+
sign
*
b
+
	`log
(z/(
C
-z));

1330 
√wt⁄_ôî
++;

1331 
ö√r_ôî
++;

1334 if(
ö√r_ôî
 > 0)

1336 
Æpha
[
öd1
] = 
z
;

1337 
Æpha
[
öd2
] = 
C
-
z
;

1338 
xi
 = 
¥ob
->
x
[
i
];

1339 
xi
->
ödex
 != -1)

1341 
w
[
xi
->
ödex
-1] +
sign
*(
z
-
Æpha_ﬁd
)*
yi
*xi->
vÆue
;

1342 
xi
++;

1347 
ôî
++;

1348 if(
ôî
 % 10 == 0)

1349 
	`öfo
(".");

1351 if(
Gmax
 < 
ïs
)

1354 if(
√wt⁄_ôî
 <
l
/10)

1355 
ö√ªps
 = 
	`max
(
ö√ªps_mö
, 0.1*innereps);

1359 
	`öfo
("\n›timiz©i⁄ föished, #ôî = %d\n",
ôî
);

1360 i‡(
ôî
 >
max_ôî
)

1361 
	`öfo
("\nWARNING:Ñeaching maxÇumber of iterations\nUsing -s 0 may be faster (also see FAQ)\n\n");

1365 
v
 = 0;

1366 
i
=0; i<
w_size
; i++)

1367 
v
 +
w
[
i
] * w[i];

1368 
v
 *= 0.5;

1369 
i
=0; i<
l
; i++)

1370 
v
 +
Æpha
[2*
i
] * 
	`log
(alpha[2*i]) +álpha[2*i+1] *Üog(alpha[2*i+1])

1371 - 
uµî_bound
[
	`GETI
(
i
)] * 
	`log
(upper_bound[GETI(i)]);

1372 
	`öfo
("Obje˘ivêvÆuê%lf\n", 
v
);

1374 
dñëe
 [] 
xTx
;

1375 
dñëe
 [] 
Æpha
;

1376 
dñëe
 [] 
y
;

1377 
dñëe
 [] 
ödex
;

1378 
	}
}

1393 #unde‡
GETI


1394 
	#GETI
(
i
Ë(
y
[i]+1)

	)

1397 
	$sﬁve_l1r_l2_svc
(

1398 
¥obÀm
 *
¥ob_cﬁ
, *
w
, 
ïs
,

1399 
Cp
, 
Cn
)

1401 
l
 = 
¥ob_cﬁ
->l;

1402 
w_size
 = 
¥ob_cﬁ
->
n
;

1403 
j
, 
s
, 
ôî
 = 0;

1404 
max_ôî
 = 1000;

1405 
a˘ive_size
 = 
w_size
;

1406 
max_num_löe£¨ch
 = 20;

1408 
sigma
 = 0.01;

1409 
d
, 
G_loss
, 
G
, 
H
;

1410 
Gmax_ﬁd
 = 
INF
;

1411 
Gmax_√w
, 
Gn‹m1_√w
;

1412 
Gn‹m1_öô
 = -1.0;

1413 
d_ﬁd
, 
d_diff
;

1414 
loss_ﬁd
, 
loss_√w
;

1415 
≠pxc⁄d
, 
c⁄d
;

1417 *
ödex
 = 
√w
 [
w_size
];

1418 
sch¨
 *
y
 = 
√w
 sch¨[
l
];

1419 *
b
 = 
√w
 [
l
];

1420 *
xj_sq
 = 
√w
 [
w_size
];

1421 
„©uª_node
 *
x
;

1423 
C
[3] = {
Cn
,0,
Cp
};

1426 
j
=0; j<
w_size
; j++)

1427 
w
[
j
] = 0;

1429 
j
=0; j<
l
; j++)

1431 
b
[
j
] = 1;

1432 if(
¥ob_cﬁ
->
y
[
j
] > 0)

1433 
y
[
j
] = 1;

1435 
y
[
j
] = -1;

1437 
j
=0; j<
w_size
; j++)

1439 
ödex
[
j
] = j;

1440 
xj_sq
[
j
] = 0;

1441 
x
 = 
¥ob_cﬁ
->x[
j
];

1442 
x
->
ödex
 != -1)

1444 
öd
 = 
x
->
ödex
-1;

1445 
x
->
vÆue
 *
y
[
öd
];

1446 
vÆ
 = 
x
->
vÆue
;

1447 
b
[
öd
] -
w
[
j
]*
vÆ
;

1448 
xj_sq
[
j
] +
C
[
	`GETI
(
öd
)]*
vÆ
*val;

1449 
x
++;

1453 
ôî
 < 
max_ôî
)

1455 
Gmax_√w
 = 0;

1456 
Gn‹m1_√w
 = 0;

1458 
j
=0; j<
a˘ive_size
; j++)

1460 
i
 = 
j
+
	`ønd
()%(
a˘ive_size
-j);

1461 
	`sw≠
(
ödex
[
i
], index[
j
]);

1464 
s
=0; s<
a˘ive_size
; s++)

1466 
j
 = 
ödex
[
s
];

1467 
G_loss
 = 0;

1468 
H
 = 0;

1470 
x
 = 
¥ob_cﬁ
->x[
j
];

1471 
x
->
ödex
 != -1)

1473 
öd
 = 
x
->
ödex
-1;

1474 if(
b
[
öd
] > 0)

1476 
vÆ
 = 
x
->
vÆue
;

1477 
tmp
 = 
C
[
	`GETI
(
öd
)]*
vÆ
;

1478 
G_loss
 -
tmp
*
b
[
öd
];

1479 
H
 +
tmp
*
vÆ
;

1481 
x
++;

1483 
G_loss
 *= 2;

1485 
G
 = 
G_loss
;

1486 
H
 *= 2;

1487 
H
 = 
	`max
(H, 1e-12);

1489 
Gp
 = 
G
+1;

1490 
Gn
 = 
G
-1;

1491 
viﬁ©i⁄
 = 0;

1492 if(
w
[
j
] == 0)

1494 if(
Gp
 < 0)

1495 
viﬁ©i⁄
 = -
Gp
;

1496 if(
Gn
 > 0)

1497 
viﬁ©i⁄
 = 
Gn
;

1498 if(
Gp
>
Gmax_ﬁd
/
l
 && 
Gn
<-Gmax_old/l)

1500 
a˘ive_size
--;

1501 
	`sw≠
(
ödex
[
s
], index[
a˘ive_size
]);

1502 
s
--;

1506 if(
w
[
j
] > 0)

1507 
viﬁ©i⁄
 = 
	`Ábs
(
Gp
);

1509 
viﬁ©i⁄
 = 
	`Ábs
(
Gn
);

1511 
Gmax_√w
 = 
	`max
(Gmax_√w, 
viﬁ©i⁄
);

1512 
Gn‹m1_√w
 +
viﬁ©i⁄
;

1515 if(
Gp
 < 
H
*
w
[
j
])

1516 
d
 = -
Gp
/
H
;

1517 if(
Gn
 > 
H
*
w
[
j
])

1518 
d
 = -
Gn
/
H
;

1520 
d
 = -
w
[
j
];

1522 if(
	`Ábs
(
d
) < 1.0e-12)

1525 
dñè
 = 
	`Ábs
(
w
[
j
]+
d
)-Ábs(w[j]Ë+ 
G
*d;

1526 
d_ﬁd
 = 0;

1527 
num_löe£¨ch
;

1528 
num_löe£¨ch
=0;Çum_löe£¨ch < 
max_num_löe£¨ch
;Çum_linesearch++)

1530 
d_diff
 = 
d_ﬁd
 - 
d
;

1531 
c⁄d
 = 
	`Ábs
(
w
[
j
]+
d
)-Ábs(w[j]Ë- 
sigma
*
dñè
;

1533 
≠pxc⁄d
 = 
xj_sq
[
j
]*
d
*d + 
G_loss
*d + 
c⁄d
;

1534 if(
≠pxc⁄d
 <= 0)

1536 
x
 = 
¥ob_cﬁ
->x[
j
];

1537 
x
->
ödex
 != -1)

1539 
b
[
x
->
ödex
-1] +
d_diff
*x->
vÆue
;

1540 
x
++;

1545 if(
num_löe£¨ch
 == 0)

1547 
loss_ﬁd
 = 0;

1548 
loss_√w
 = 0;

1549 
x
 = 
¥ob_cﬁ
->x[
j
];

1550 
x
->
ödex
 != -1)

1552 
öd
 = 
x
->
ödex
-1;

1553 if(
b
[
öd
] > 0)

1554 
loss_ﬁd
 +
C
[
	`GETI
(
öd
)]*
b
[ind]*b[ind];

1555 
b_√w
 = 
b
[
öd
] + 
d_diff
*
x
->
vÆue
;

1556 
b
[
öd
] = 
b_√w
;

1557 if(
b_√w
 > 0)

1558 
loss_√w
 +
C
[
	`GETI
(
öd
)]*
b_√w
*b_new;

1559 
x
++;

1564 
loss_√w
 = 0;

1565 
x
 = 
¥ob_cﬁ
->x[
j
];

1566 
x
->
ödex
 != -1)

1568 
öd
 = 
x
->
ödex
-1;

1569 
b_√w
 = 
b
[
öd
] + 
d_diff
*
x
->
vÆue
;

1570 
b
[
öd
] = 
b_√w
;

1571 if(
b_√w
 > 0)

1572 
loss_√w
 +
C
[
	`GETI
(
öd
)]*
b_√w
*b_new;

1573 
x
++;

1577 
c⁄d
 = c⁄d + 
loss_√w
 - 
loss_ﬁd
;

1578 if(
c⁄d
 <= 0)

1582 
d_ﬁd
 = 
d
;

1583 
d
 *= 0.5;

1584 
dñè
 *= 0.5;

1588 
w
[
j
] +
d
;

1591 if(
num_löe£¨ch
 >
max_num_löe£¨ch
)

1593 
	`öfo
("#");

1594 
i
=0; i<
l
; i++)

1595 
b
[
i
] = 1;

1597 
i
=0; i<
w_size
; i++)

1599 if(
w
[
i
]==0) ;

1600 
x
 = 
¥ob_cﬁ
->x[
i
];

1601 
x
->
ödex
 != -1)

1603 
b
[
x
->
ödex
-1] -
w
[
i
]*x->
vÆue
;

1604 
x
++;

1610 if(
ôî
 == 0)

1611 
Gn‹m1_öô
 = 
Gn‹m1_√w
;

1612 
ôî
++;

1613 if(
ôî
 % 10 == 0)

1614 
	`öfo
(".");

1616 if(
Gn‹m1_√w
 <
ïs
*
Gn‹m1_öô
)

1618 if(
a˘ive_size
 =
w_size
)

1622 
a˘ive_size
 = 
w_size
;

1623 
	`öfo
("*");

1624 
Gmax_ﬁd
 = 
INF
;

1629 
Gmax_ﬁd
 = 
Gmax_√w
;

1632 
	`öfo
("\n›timiz©i⁄ föished, #ôî = %d\n", 
ôî
);

1633 if(
ôî
 >
max_ôî
)

1634 
	`öfo
("\nWARNING:Ñeaching maxÇumber of iterations\n");

1638 
v
 = 0;

1639 
¬z
 = 0;

1640 
j
=0; j<
w_size
; j++)

1642 
x
 = 
¥ob_cﬁ
->x[
j
];

1643 
x
->
ödex
 != -1)

1645 
x
->
vÆue
 *
¥ob_cﬁ
->
y
[x->
ödex
-1];

1646 
x
++;

1648 if(
w
[
j
] != 0)

1650 
v
 +
	`Ábs
(
w
[
j
]);

1651 
¬z
++;

1654 
j
=0; j<
l
; j++)

1655 if(
b
[
j
] > 0)

1656 
v
 +
C
[
	`GETI
(
j
)]*
b
[j]*b[j];

1658 
	`öfo
("Obje˘ivêvÆuê%lf\n", 
v
);

1659 
	`öfo
("#n⁄zîos/#„©uª†%d/%d\n", 
¬z
, 
w_size
);

1661 
dñëe
 [] 
ödex
;

1662 
dñëe
 [] 
y
;

1663 
dñëe
 [] 
b
;

1664 
dñëe
 [] 
xj_sq
;

1665 
	}
}

1680 #unde‡
GETI


1681 
	#GETI
(
i
Ë(
y
[i]+1)

	)

1684 
	$sﬁve_l1r_Ã
(

1685 c⁄° 
¥obÀm
 *
¥ob_cﬁ
, *
w
, 
ïs
,

1686 
Cp
, 
Cn
)

1688 
l
 = 
¥ob_cﬁ
->l;

1689 
w_size
 = 
¥ob_cﬁ
->
n
;

1690 
j
, 
s
, 
√wt⁄_ôî
=0, 
ôî
=0;

1691 
max_√wt⁄_ôî
 = 100;

1692 
max_ôî
 = 1000;

1693 
max_num_löe£¨ch
 = 20;

1694 
a˘ive_size
;

1695 
QP_a˘ive_size
;

1697 
nu
 = 1e-12;

1698 
ö√r_ïs
 = 1;

1699 
sigma
 = 0.01;

1700 
w_n‹m
, 
w_n‹m_√w
;

1701 
z
, 
G
, 
H
;

1702 
Gn‹m1_öô
 = -1.0;

1703 
Gmax_ﬁd
 = 
INF
;

1704 
Gmax_√w
, 
Gn‹m1_√w
;

1705 
QP_Gmax_ﬁd
 = 
INF
;

1706 
QP_Gmax_√w
, 
QP_Gn‹m1_√w
;

1707 
dñè
, 
√gsum_xTd
, 
c⁄d
;

1709 *
ödex
 = 
√w
 [
w_size
];

1710 
sch¨
 *
y
 = 
√w
 sch¨[
l
];

1711 *
Hdüg
 = 
√w
 [
w_size
];

1712 *
Gød
 = 
√w
 [
w_size
];

1713 *
wpd
 = 
√w
 [
w_size
];

1714 *
xj√g_sum
 = 
√w
 [
w_size
];

1715 *
xTd
 = 
√w
 [
l
];

1716 *
exp_wTx
 = 
√w
 [
l
];

1717 *
exp_wTx_√w
 = 
√w
 [
l
];

1718 *
èu
 = 
√w
 [
l
];

1719 *
D
 = 
√w
 [
l
];

1720 
„©uª_node
 *
x
;

1722 
C
[3] = {
Cn
,0,
Cp
};

1725 
j
=0; j<
w_size
; j++)

1726 
w
[
j
] = 0;

1728 
j
=0; j<
l
; j++)

1730 if(
¥ob_cﬁ
->
y
[
j
] > 0)

1731 
y
[
j
] = 1;

1733 
y
[
j
] = -1;

1735 
exp_wTx
[
j
] = 0;

1738 
w_n‹m
 = 0;

1739 
j
=0; j<
w_size
; j++)

1741 
w_n‹m
 +
	`Ábs
(
w
[
j
]);

1742 
wpd
[
j
] = 
w
[j];

1743 
ödex
[
j
] = j;

1744 
xj√g_sum
[
j
] = 0;

1745 
x
 = 
¥ob_cﬁ
->x[
j
];

1746 
x
->
ödex
 != -1)

1748 
öd
 = 
x
->
ödex
-1;

1749 
vÆ
 = 
x
->
vÆue
;

1750 
exp_wTx
[
öd
] +
w
[
j
]*
vÆ
;

1751 if(
y
[
öd
] == -1)

1752 
xj√g_sum
[
j
] +
C
[
	`GETI
(
öd
)]*
vÆ
;

1753 
x
++;

1756 
j
=0; j<
l
; j++)

1758 
exp_wTx
[
j
] = 
	`exp
(exp_wTx[j]);

1759 
èu_tmp
 = 1/(1+
exp_wTx
[
j
]);

1760 
èu
[
j
] = 
C
[
	`GETI
(j)]*
èu_tmp
;

1761 
D
[
j
] = 
C
[
	`GETI
(j)]*
exp_wTx
[j]*
èu_tmp
*tau_tmp;

1764 
√wt⁄_ôî
 < 
max_√wt⁄_ôî
)

1766 
Gmax_√w
 = 0;

1767 
Gn‹m1_√w
 = 0;

1768 
a˘ive_size
 = 
w_size
;

1770 
s
=0; s<
a˘ive_size
; s++)

1772 
j
 = 
ödex
[
s
];

1773 
Hdüg
[
j
] = 
nu
;

1774 
Gød
[
j
] = 0;

1776 
tmp
 = 0;

1777 
x
 = 
¥ob_cﬁ
->x[
j
];

1778 
x
->
ödex
 != -1)

1780 
öd
 = 
x
->
ödex
-1;

1781 
Hdüg
[
j
] +
x
->
vÆue
*x->vÆue*
D
[
öd
];

1782 
tmp
 +
x
->
vÆue
*
èu
[
öd
];

1783 
x
++;

1785 
Gød
[
j
] = -
tmp
 + 
xj√g_sum
[j];

1787 
Gp
 = 
Gød
[
j
]+1;

1788 
Gn
 = 
Gød
[
j
]-1;

1789 
viﬁ©i⁄
 = 0;

1790 if(
w
[
j
] == 0)

1792 if(
Gp
 < 0)

1793 
viﬁ©i⁄
 = -
Gp
;

1794 if(
Gn
 > 0)

1795 
viﬁ©i⁄
 = 
Gn
;

1797 if(
Gp
>
Gmax_ﬁd
/
l
 && 
Gn
<-Gmax_old/l)

1799 
a˘ive_size
--;

1800 
	`sw≠
(
ödex
[
s
], index[
a˘ive_size
]);

1801 
s
--;

1805 if(
w
[
j
] > 0)

1806 
viﬁ©i⁄
 = 
	`Ábs
(
Gp
);

1808 
viﬁ©i⁄
 = 
	`Ábs
(
Gn
);

1810 
Gmax_√w
 = 
	`max
(Gmax_√w, 
viﬁ©i⁄
);

1811 
Gn‹m1_√w
 +
viﬁ©i⁄
;

1814 if(
√wt⁄_ôî
 == 0)

1815 
Gn‹m1_öô
 = 
Gn‹m1_√w
;

1817 if(
Gn‹m1_√w
 <
ïs
*
Gn‹m1_öô
)

1820 
ôî
 = 0;

1821 
QP_Gmax_ﬁd
 = 
INF
;

1822 
QP_a˘ive_size
 = 
a˘ive_size
;

1824 
i
=0; i<
l
; i++)

1825 
xTd
[
i
] = 0;

1828 
ôî
 < 
max_ôî
)

1830 
QP_Gmax_√w
 = 0;

1831 
QP_Gn‹m1_√w
 = 0;

1833 
j
=0; j<
QP_a˘ive_size
; j++)

1835 
i
 = 
j
+
	`ønd
()%(
QP_a˘ive_size
-j);

1836 
	`sw≠
(
ödex
[
i
], index[
j
]);

1839 
s
=0; s<
QP_a˘ive_size
; s++)

1841 
j
 = 
ödex
[
s
];

1842 
H
 = 
Hdüg
[
j
];

1844 
x
 = 
¥ob_cﬁ
->x[
j
];

1845 
G
 = 
Gød
[
j
] + (
wpd
[j]-
w
[j])*
nu
;

1846 
x
->
ödex
 != -1)

1848 
öd
 = 
x
->
ödex
-1;

1849 
G
 +
x
->
vÆue
*
D
[
öd
]*
xTd
[ind];

1850 
x
++;

1853 
Gp
 = 
G
+1;

1854 
Gn
 = 
G
-1;

1855 
viﬁ©i⁄
 = 0;

1856 if(
wpd
[
j
] == 0)

1858 if(
Gp
 < 0)

1859 
viﬁ©i⁄
 = -
Gp
;

1860 if(
Gn
 > 0)

1861 
viﬁ©i⁄
 = 
Gn
;

1863 if(
Gp
>
QP_Gmax_ﬁd
/
l
 && 
Gn
<-QP_Gmax_old/l)

1865 
QP_a˘ive_size
--;

1866 
	`sw≠
(
ödex
[
s
], index[
QP_a˘ive_size
]);

1867 
s
--;

1871 if(
wpd
[
j
] > 0)

1872 
viﬁ©i⁄
 = 
	`Ábs
(
Gp
);

1874 
viﬁ©i⁄
 = 
	`Ábs
(
Gn
);

1876 
QP_Gmax_√w
 = 
	`max
(QP_Gmax_√w, 
viﬁ©i⁄
);

1877 
QP_Gn‹m1_√w
 +
viﬁ©i⁄
;

1880 if(
Gp
 < 
H
*
wpd
[
j
])

1881 
z
 = -
Gp
/
H
;

1882 if(
Gn
 > 
H
*
wpd
[
j
])

1883 
z
 = -
Gn
/
H
;

1885 
z
 = -
wpd
[
j
];

1887 if(
	`Ábs
(
z
) < 1.0e-12)

1889 
z
 = 
	`mö
(
	`max
(z,-10.0),10.0);

1891 
wpd
[
j
] +
z
;

1893 
x
 = 
¥ob_cﬁ
->x[
j
];

1894 
x
->
ödex
 != -1)

1896 
öd
 = 
x
->
ödex
-1;

1897 
xTd
[
öd
] +
x
->
vÆue
*
z
;

1898 
x
++;

1902 
ôî
++;

1904 if(
QP_Gn‹m1_√w
 <
ö√r_ïs
*
Gn‹m1_öô
)

1907 if(
QP_a˘ive_size
 =
a˘ive_size
)

1912 
QP_a˘ive_size
 = 
a˘ive_size
;

1913 
QP_Gmax_ﬁd
 = 
INF
;

1918 
QP_Gmax_ﬁd
 = 
QP_Gmax_√w
;

1921 if(
ôî
 >
max_ôî
)

1922 
	`öfo
("WARNING:Ñeaching maxÇumber of inner iterations\n");

1924 
dñè
 = 0;

1925 
w_n‹m_√w
 = 0;

1926 
j
=0; j<
w_size
; j++)

1928 
dñè
 +
Gød
[
j
]*(
wpd
[j]-
w
[j]);

1929 if(
wpd
[
j
] != 0)

1930 
w_n‹m_√w
 +
	`Ábs
(
wpd
[
j
]);

1932 
dñè
 +(
w_n‹m_√w
-
w_n‹m
);

1934 
√gsum_xTd
 = 0;

1935 
i
=0; i<
l
; i++)

1936 if(
y
[
i
] == -1)

1937 
√gsum_xTd
 +
C
[
	`GETI
(
i
)]*
xTd
[i];

1939 
num_löe£¨ch
;

1940 
num_löe£¨ch
=0;Çum_löe£¨ch < 
max_num_löe£¨ch
;Çum_linesearch++)

1942 
c⁄d
 = 
w_n‹m_√w
 - 
w_n‹m
 + 
√gsum_xTd
 - 
sigma
*
dñè
;

1944 
i
=0; i<
l
; i++)

1946 
exp_xTd
 = 
	`exp
(
xTd
[
i
]);

1947 
exp_wTx_√w
[
i
] = 
exp_wTx
[i]*
exp_xTd
;

1948 
c⁄d
 +
C
[
	`GETI
(
i
)]*
	`log
((1+
exp_wTx_√w
[i])/(
exp_xTd
+exp_wTx_new[i]));

1951 if(
c⁄d
 <= 0)

1953 
w_n‹m
 = 
w_n‹m_√w
;

1954 
j
=0; j<
w_size
; j++)

1955 
w
[
j
] = 
wpd
[j];

1956 
i
=0; i<
l
; i++)

1958 
exp_wTx
[
i
] = 
exp_wTx_√w
[i];

1959 
èu_tmp
 = 1/(1+
exp_wTx
[
i
]);

1960 
èu
[
i
] = 
C
[
	`GETI
(i)]*
èu_tmp
;

1961 
D
[
i
] = 
C
[
	`GETI
(i)]*
exp_wTx
[i]*
èu_tmp
*tau_tmp;

1967 
w_n‹m_√w
 = 0;

1968 
j
=0; j<
w_size
; j++)

1970 
wpd
[
j
] = (
w
[j]+wpd[j])*0.5;

1971 if(
wpd
[
j
] != 0)

1972 
w_n‹m_√w
 +
	`Ábs
(
wpd
[
j
]);

1974 
dñè
 *= 0.5;

1975 
√gsum_xTd
 *= 0.5;

1976 
i
=0; i<
l
; i++)

1977 
xTd
[
i
] *= 0.5;

1982 if(
num_löe£¨ch
 >
max_num_löe£¨ch
)

1984 
i
=0; i<
l
; i++)

1985 
exp_wTx
[
i
] = 0;

1987 
i
=0; i<
w_size
; i++)

1989 if(
w
[
i
]==0) ;

1990 
x
 = 
¥ob_cﬁ
->x[
i
];

1991 
x
->
ödex
 != -1)

1993 
exp_wTx
[
x
->
ödex
-1] +
w
[
i
]*x->
vÆue
;

1994 
x
++;

1998 
i
=0; i<
l
; i++)

1999 
exp_wTx
[
i
] = 
	`exp
(exp_wTx[i]);

2002 if(
ôî
 == 1)

2003 
ö√r_ïs
 *= 0.25;

2005 
√wt⁄_ôî
++;

2006 
Gmax_ﬁd
 = 
Gmax_√w
;

2008 
	`öfo
("ôî %3d #CD cy˛e†%d\n", 
√wt⁄_ôî
, 
ôî
);

2011 
	`öfo
("=========================\n");

2012 
	`öfo
("›timiz©i⁄ föished, #ôî = %d\n", 
√wt⁄_ôî
);

2013 if(
√wt⁄_ôî
 >
max_√wt⁄_ôî
)

2014 
	`öfo
("WARNING:Ñeaching maxÇumber of iterations\n");

2018 
v
 = 0;

2019 
¬z
 = 0;

2020 
j
=0; j<
w_size
; j++)

2021 if(
w
[
j
] != 0)

2023 
v
 +
	`Ábs
(
w
[
j
]);

2024 
¬z
++;

2026 
j
=0; j<
l
; j++)

2027 if(
y
[
j
] == 1)

2028 
v
 +
C
[
	`GETI
(
j
)]*
	`log
(1+1/
exp_wTx
[j]);

2030 
v
 +
C
[
	`GETI
(
j
)]*
	`log
(1+
exp_wTx
[j]);

2032 
	`öfo
("Obje˘ivêvÆuê%lf\n", 
v
);

2033 
	`öfo
("#n⁄zîos/#„©uª†%d/%d\n", 
¬z
, 
w_size
);

2035 
dñëe
 [] 
ödex
;

2036 
dñëe
 [] 
y
;

2037 
dñëe
 [] 
Hdüg
;

2038 
dñëe
 [] 
Gød
;

2039 
dñëe
 [] 
wpd
;

2040 
dñëe
 [] 
xj√g_sum
;

2041 
dñëe
 [] 
xTd
;

2042 
dñëe
 [] 
exp_wTx
;

2043 
dñëe
 [] 
exp_wTx_√w
;

2044 
dñëe
 [] 
èu
;

2045 
dñëe
 [] 
D
;

2046 
	}
}

2049 
	$å™•o£
(c⁄° 
¥obÀm
 *
¥ob
, 
„©uª_node
 **
x_•a˚_ªt
,ÖrobÀm *
¥ob_cﬁ
)

2051 
i
;

2052 
l
 = 
¥ob
->l;

2053 
n
 = 
¥ob
->n;

2054 
size_t
 
¬z
 = 0;

2055 
size_t
 *
cﬁ_±r
 = 
√w
 size_à[
n
+1];

2056 
„©uª_node
 *
x_•a˚
;

2057 
¥ob_cﬁ
->
l
 =Ü;

2058 
¥ob_cﬁ
->
n
 =Ç;

2059 
¥ob_cﬁ
->
y
 = 
√w
 [
l
];

2060 
¥ob_cﬁ
->
x
 = 
√w
 
„©uª_node
*[
n
];

2062 
i
=0; i<
l
; i++)

2063 
¥ob_cﬁ
->
y
[
i
] = 
¥ob
->y[i];

2065 
i
=0; i<
n
+1; i++)

2066 
cﬁ_±r
[
i
] = 0;

2067 
i
=0; i<
l
; i++)

2069 
„©uª_node
 *
x
 = 
¥ob
->x[
i
];

2070 
x
->
ödex
 != -1)

2072 
¬z
++;

2073 
cﬁ_±r
[
x
->
ödex
]++;

2074 
x
++;

2077 
i
=1; i<
n
+1; i++)

2078 
cﬁ_±r
[
i
] += col_ptr[i-1] + 1;

2080 
x_•a˚
 = 
√w
 
„©uª_node
[
¬z
+
n
];

2081 
i
=0; i<
n
; i++)

2082 
¥ob_cﬁ
->
x
[
i
] = &
x_•a˚
[
cﬁ_±r
[i]];

2084 
i
=0; i<
l
; i++)

2086 
„©uª_node
 *
x
 = 
¥ob
->x[
i
];

2087 
x
->
ödex
 != -1)

2089 
öd
 = 
x
->
ödex
-1;

2090 
x_•a˚
[
cﬁ_±r
[
öd
]].
ödex
 = 
i
+1;

2091 
x_•a˚
[
cﬁ_±r
[
öd
]].
vÆue
 = 
x
->value;

2092 
cﬁ_±r
[
öd
]++;

2093 
x
++;

2096 
i
=0; i<
n
; i++)

2097 
x_•a˚
[
cﬁ_±r
[
i
]].
ödex
 = -1;

2099 *
x_•a˚_ªt
 = 
x_•a˚
;

2101 
dñëe
 [] 
cﬁ_±r
;

2102 
	}
}

2106 
	$group_˛as£s
(c⁄° 
¥obÀm
 *
¥ob
, *
ƒ_˛ass_ªt
, **
œbñ_ªt
, **
°¨t_ªt
, **
cou¡_ªt
, *
≥rm
)

2108 
l
 = 
¥ob
->l;

2109 
max_ƒ_˛ass
 = 16;

2110 
ƒ_˛ass
 = 0;

2111 *
œbñ
 = 
	`MÆloc
(,
max_ƒ_˛ass
);

2112 *
cou¡
 = 
	`MÆloc
(,
max_ƒ_˛ass
);

2113 *
d©a_œbñ
 = 
	`MÆloc
(,
l
);

2114 
i
;

2116 
i
=0;i<
l
;i++)

2118 
this_œbñ
 = ()
¥ob
->
y
[
i
];

2119 
j
;

2120 
j
=0;j<
ƒ_˛ass
;j++)

2122 if(
this_œbñ
 =
œbñ
[
j
])

2124 ++
cou¡
[
j
];

2128 
d©a_œbñ
[
i
] = 
j
;

2129 if(
j
 =
ƒ_˛ass
)

2131 if(
ƒ_˛ass
 =
max_ƒ_˛ass
)

2133 
max_ƒ_˛ass
 *= 2;

2134 
œbñ
 = (*)
	`ªÆloc
÷abñ,
max_ƒ_˛ass
*());

2135 
cou¡
 = (*)
	`ªÆloc
(cou¡,
max_ƒ_˛ass
*());

2137 
œbñ
[
ƒ_˛ass
] = 
this_œbñ
;

2138 
cou¡
[
ƒ_˛ass
] = 1;

2139 ++
ƒ_˛ass
;

2148 i‡(
ƒ_˛ass
 =2 && 
œbñ
[0] == -1 &&Üabel[1] == 1)

2150 
	`sw≠
(
œbñ
[0],label[1]);

2151 
	`sw≠
(
cou¡
[0],count[1]);

2152 
i
=0;i<
l
;i++)

2154 if(
d©a_œbñ
[
i
] == 0)

2155 
d©a_œbñ
[
i
] = 1;

2157 
d©a_œbñ
[
i
] = 0;

2161 *
°¨t
 = 
	`MÆloc
(,
ƒ_˛ass
);

2162 
°¨t
[0] = 0;

2163 
i
=1;i<
ƒ_˛ass
;i++)

2164 
°¨t
[
i
] = sèπ[i-1]+
cou¡
[i-1];

2165 
i
=0;i<
l
;i++)

2167 
≥rm
[
°¨t
[
d©a_œbñ
[
i
]]] = i;

2168 ++
°¨t
[
d©a_œbñ
[
i
]];

2170 
°¨t
[0] = 0;

2171 
i
=1;i<
ƒ_˛ass
;i++)

2172 
°¨t
[
i
] = sèπ[i-1]+
cou¡
[i-1];

2174 *
ƒ_˛ass_ªt
 = 
ƒ_˛ass
;

2175 *
œbñ_ªt
 = 
œbñ
;

2176 *
°¨t_ªt
 = 
°¨t
;

2177 *
cou¡_ªt
 = 
cou¡
;

2178 
	`‰ì
(
d©a_œbñ
);

2179 
	}
}

2181 
	$åaö_⁄e
(c⁄° 
¥obÀm
 *
¥ob
, c⁄° 
∑ømëî
 *
∑øm
, *
w
, 
Cp
, 
Cn
)

2183 
ïs
=
∑øm
->eps;

2184 
pos
 = 0;

2185 
√g
 = 0;

2186 
i
=0;i<
¥ob
->
l
;i++)

2187 if(
¥ob
->
y
[
i
] > 0)

2188 
pos
++;

2189 
√g
 = 
¥ob
->
l
 - 
pos
;

2191 
¥imÆ_sﬁvî_tﬁ
 = 
ïs
*
	`max
(
	`mö
(
pos
,
√g
), 1)/
¥ob
->
l
;

2193 
fun˘i⁄
 *
fun_obj
=
NULL
;

2194 
∑øm
->
sﬁvî_ty≥
)

2196 
L2R_LR
:

2198 *
C
 = 
√w
 [
¥ob
->
l
];

2199 
i
 = 0; i < 
¥ob
->
l
; i++)

2201 if(
¥ob
->
y
[
i
] > 0)

2202 
C
[
i
] = 
Cp
;

2204 
C
[
i
] = 
Cn
;

2206 
fun_obj
=
√w
 
	`l2r_Ã_fun
(
¥ob
, 
C
);

2207 
TRON
 
	`å⁄_obj
(
fun_obj
, 
¥imÆ_sﬁvî_tﬁ
);

2208 
å⁄_obj
.
	`£t_¥öt_°rög
(
liblöór_¥öt_°rög
);

2209 
å⁄_obj
.
	`å⁄
(
w
);

2210 
dñëe
 
fun_obj
;

2211 
dñëe
[] 
C
;

2214 
L2R_L2LOSS_SVC
:

2216 *
C
 = 
√w
 [
¥ob
->
l
];

2217 
i
 = 0; i < 
¥ob
->
l
; i++)

2219 if(
¥ob
->
y
[
i
] > 0)

2220 
C
[
i
] = 
Cp
;

2222 
C
[
i
] = 
Cn
;

2224 
fun_obj
=
√w
 
	`l2r_l2_svc_fun
(
¥ob
, 
C
);

2225 
TRON
 
	`å⁄_obj
(
fun_obj
, 
¥imÆ_sﬁvî_tﬁ
);

2226 
å⁄_obj
.
	`£t_¥öt_°rög
(
liblöór_¥öt_°rög
);

2227 
å⁄_obj
.
	`å⁄
(
w
);

2228 
dñëe
 
fun_obj
;

2229 
dñëe
[] 
C
;

2232 
L2R_L2LOSS_SVC_DUAL
:

2233 
	`sﬁve_l2r_l1l2_svc
(
¥ob
, 
w
, 
ïs
, 
Cp
, 
Cn
, 
L2R_L2LOSS_SVC_DUAL
);

2235 
L2R_L1LOSS_SVC_DUAL
:

2236 
	`sﬁve_l2r_l1l2_svc
(
¥ob
, 
w
, 
ïs
, 
Cp
, 
Cn
, 
L2R_L1LOSS_SVC_DUAL
);

2238 
L1R_L2LOSS_SVC
:

2240 
¥obÀm
 
¥ob_cﬁ
;

2241 
„©uª_node
 *
x_•a˚
 = 
NULL
;

2242 
	`å™•o£
(
¥ob
, &
x_•a˚
 ,&
¥ob_cﬁ
);

2243 
	`sﬁve_l1r_l2_svc
(&
¥ob_cﬁ
, 
w
, 
¥imÆ_sﬁvî_tﬁ
, 
Cp
, 
Cn
);

2244 
dñëe
 [] 
¥ob_cﬁ
.
y
;

2245 
dñëe
 [] 
¥ob_cﬁ
.
x
;

2246 
dñëe
 [] 
x_•a˚
;

2249 
L1R_LR
:

2251 
¥obÀm
 
¥ob_cﬁ
;

2252 
„©uª_node
 *
x_•a˚
 = 
NULL
;

2253 
	`å™•o£
(
¥ob
, &
x_•a˚
 ,&
¥ob_cﬁ
);

2254 
	`sﬁve_l1r_Ã
(&
¥ob_cﬁ
, 
w
, 
¥imÆ_sﬁvî_tﬁ
, 
Cp
, 
Cn
);

2255 
dñëe
 [] 
¥ob_cﬁ
.
y
;

2256 
dñëe
 [] 
¥ob_cﬁ
.
x
;

2257 
dñëe
 [] 
x_•a˚
;

2260 
L2R_LR_DUAL
:

2261 
	`sﬁve_l2r_Ã_duÆ
(
¥ob
, 
w
, 
ïs
, 
Cp
, 
Cn
);

2263 
L2R_L2LOSS_SVR
:

2265 *
C
 = 
√w
 [
¥ob
->
l
];

2266 
i
 = 0; i < 
¥ob
->
l
; i++)

2267 
C
[
i
] = 
∑øm
->C;

2269 
fun_obj
=
√w
 
	`l2r_l2_svr_fun
(
¥ob
, 
C
, 
∑øm
->
p
);

2270 
TRON
 
	`å⁄_obj
(
fun_obj
, 
∑øm
->
ïs
);

2271 
å⁄_obj
.
	`£t_¥öt_°rög
(
liblöór_¥öt_°rög
);

2272 
å⁄_obj
.
	`å⁄
(
w
);

2273 
dñëe
 
fun_obj
;

2274 
dñëe
[] 
C
;

2278 
L2R_L1LOSS_SVR_DUAL
:

2279 
	`sﬁve_l2r_l1l2_svr
(
¥ob
, 
w
, 
∑øm
, 
L2R_L1LOSS_SVR_DUAL
);

2281 
L2R_L2LOSS_SVR_DUAL
:

2282 
	`sﬁve_l2r_l1l2_svr
(
¥ob
, 
w
, 
∑øm
, 
L2R_L2LOSS_SVR_DUAL
);

2285 
	`Ârötf
(
°dîr
, "ERROR: unknown solver_type\n");

2288 
	}
}

2293 
modñ
* 
	$åaö
(c⁄° 
¥obÀm
 *
¥ob
, c⁄° 
∑ømëî
 *
∑øm
)

2295 
i
,
j
;

2296 
l
 = 
¥ob
->l;

2297 
n
 = 
¥ob
->n;

2298 
w_size
 = 
¥ob
->
n
;

2299 
modñ
 *
modñ_
 = 
	`MÆloc
(model,1);

2301 if(
¥ob
->
büs
>=0)

2302 
modñ_
->
ƒ_„©uª
=
n
-1;

2304 
modñ_
->
ƒ_„©uª
=
n
;

2305 
modñ_
->
∑øm
 = *param;

2306 
modñ_
->
büs
 = 
¥ob
->bias;

2308 if(
	`check_ªgªssi⁄_modñ
(
modñ_
))

2310 
modñ_
->
w
 = 
	`MÆloc
(, 
w_size
);

2311 
modñ_
->
ƒ_˛ass
 = 2;

2312 
modñ_
->
œbñ
 = 
NULL
;

2313 
	`åaö_⁄e
(
¥ob
, 
∑øm
, &
modñ_
->
w
[0], 0, 0);

2317 
ƒ_˛ass
;

2318 *
œbñ
 = 
NULL
;

2319 *
°¨t
 = 
NULL
;

2320 *
cou¡
 = 
NULL
;

2321 *
≥rm
 = 
	`MÆloc
(,
l
);

2324 
	`group_˛as£s
(
¥ob
,&
ƒ_˛ass
,&
œbñ
,&
°¨t
,&
cou¡
,
≥rm
);

2326 
modñ_
->
ƒ_˛ass
=nr_class;

2327 
modñ_
->
œbñ
 = 
	`MÆloc
(,
ƒ_˛ass
);

2328 
i
=0;i<
ƒ_˛ass
;i++)

2329 
modñ_
->
œbñ
[
i
] =Üabel[i];

2332 *
weighãd_C
 = 
	`MÆloc
(, 
ƒ_˛ass
);

2333 
i
=0;i<
ƒ_˛ass
;i++)

2334 
weighãd_C
[
i
] = 
∑øm
->
C
;

2335 
i
=0;i<
∑øm
->
ƒ_weight
;i++)

2337 
j
=0;j<
ƒ_˛ass
;j++)

2338 if(
∑øm
->
weight_œbñ
[
i
] =
œbñ
[
j
])

2340 if(
j
 =
ƒ_˛ass
)

2341 
	`Ârötf
(
°dîr
,"WARNING: cœs†œbñ %d s≥cifõd i¿weighài†nŸ found\n", 
∑øm
->
weight_œbñ
[
i
]);

2343 
weighãd_C
[
j
] *
∑øm
->
weight
[
i
];

2347 
„©uª_node
 **
x
 = 
	`MÆloc
(„©uª_nodê*,
l
);

2348 
i
=0;i<
l
;i++)

2349 
x
[
i
] = 
¥ob
->x[
≥rm
[i]];

2351 
k
;

2352 
¥obÀm
 
sub_¥ob
;

2353 
sub_¥ob
.
l
 =Ü;

2354 
sub_¥ob
.
n
 =Ç;

2355 
sub_¥ob
.
x
 = 
	`MÆloc
(
„©uª_node
 *,sub_¥ob.
l
);

2356 
sub_¥ob
.
y
 = 
	`MÆloc
(,sub_¥ob.
l
);

2358 
k
=0; k<
sub_¥ob
.
l
; k++)

2359 
sub_¥ob
.
x
[
k
] = x[k];

2362 if(
∑øm
->
sﬁvî_ty≥
 =
MCSVM_CS
)

2364 
modñ_
->
w
=
	`MÆloc
(, 
n
*
ƒ_˛ass
);

2365 
i
=0;i<
ƒ_˛ass
;i++)

2366 
j
=
°¨t
[
i
];j<°¨t[i]+
cou¡
[i];j++)

2367 
sub_¥ob
.
y
[
j
] = 
i
;

2368 
Sﬁvî_MCSVM_CS
 
	`Sﬁvî
(&
sub_¥ob
, 
ƒ_˛ass
, 
weighãd_C
, 
∑øm
->
ïs
);

2369 
Sﬁvî
.
	`Sﬁve
(
modñ_
->
w
);

2373 if(
ƒ_˛ass
 == 2)

2375 
modñ_
->
w
=
	`MÆloc
(, 
w_size
);

2377 
e0
 = 
°¨t
[0]+
cou¡
[0];

2378 
k
=0;

2379 ; 
k
<
e0
; k++)

2380 
sub_¥ob
.
y
[
k
] = +1;

2381 ; 
k
<
sub_¥ob
.
l
; k++)

2382 
sub_¥ob
.
y
[
k
] = -1;

2384 
	`åaö_⁄e
(&
sub_¥ob
, 
∑øm
, &
modñ_
->
w
[0], 
weighãd_C
[0], weighted_C[1]);

2388 
modñ_
->
w
=
	`MÆloc
(, 
w_size
*
ƒ_˛ass
);

2389 *
w
=
	`MÆloc
(, 
w_size
);

2390 
i
=0;i<
ƒ_˛ass
;i++)

2392 
si
 = 
°¨t
[
i
];

2393 
ei
 = 
si
+
cou¡
[
i
];

2395 
k
=0;

2396 ; 
k
<
si
; k++)

2397 
sub_¥ob
.
y
[
k
] = -1;

2398 ; 
k
<
ei
; k++)

2399 
sub_¥ob
.
y
[
k
] = +1;

2400 ; 
k
<
sub_¥ob
.
l
; k++)

2401 
sub_¥ob
.
y
[
k
] = -1;

2403 
	`åaö_⁄e
(&
sub_¥ob
, 
∑øm
, 
w
, 
weighãd_C
[
i
],Ö¨am->
C
);

2405 
j
=0;j<
w_size
;j++)

2406 
modñ_
->
w
[
j
*
ƒ_˛ass
+
i
] = w[j];

2408 
	`‰ì
(
w
);

2413 
	`‰ì
(
x
);

2414 
	`‰ì
(
œbñ
);

2415 
	`‰ì
(
°¨t
);

2416 
	`‰ì
(
cou¡
);

2417 
	`‰ì
(
≥rm
);

2418 
	`‰ì
(
sub_¥ob
.
x
);

2419 
	`‰ì
(
sub_¥ob
.
y
);

2420 
	`‰ì
(
weighãd_C
);

2422  
modñ_
;

2423 
	}
}

2425 
	$¸oss_vÆid©i⁄
(c⁄° 
¥obÀm
 *
¥ob
, c⁄° 
∑ømëî
 *
∑øm
, 
ƒ_fﬁd
, *
èrgë
)

2427 
i
;

2428 *
fﬁd_°¨t
;

2429 
l
 = 
¥ob
->l;

2430 *
≥rm
 = 
	`MÆloc
(,
l
);

2431 i‡(
ƒ_fﬁd
 > 
l
)

2433 
ƒ_fﬁd
 = 
l
;

2434 
	`Ârötf
(
°dîr
,"WARNING: # folds > # data. Will use # folds = # data instead (i.e.,Üeave-one-out cross validation)\n");

2436 
fﬁd_°¨t
 = 
	`MÆloc
(,
ƒ_fﬁd
+1);

2437 
i
=0;i<
l
;i++Ë
≥rm
[i]=i;

2438 
i
=0;i<
l
;i++)

2440 
j
 = 
i
+
	`ønd
()%(
l
-i);

2441 
	`sw≠
(
≥rm
[
i
],≥rm[
j
]);

2443 
i
=0;i<=
ƒ_fﬁd
;i++)

2444 
fﬁd_°¨t
[
i
]=i*
l
/
ƒ_fﬁd
;

2446 
i
=0;i<
ƒ_fﬁd
;i++)

2448 
begö
 = 
fﬁd_°¨t
[
i
];

2449 
íd
 = 
fﬁd_°¨t
[
i
+1];

2450 
j
,
k
;

2451 
¥obÀm
 
sub¥ob
;

2453 
sub¥ob
.
büs
 = 
¥ob
->bias;

2454 
sub¥ob
.
n
 = 
¥ob
->n;

2455 
sub¥ob
.
l
 =Ü-(
íd
-
begö
);

2456 
sub¥ob
.
x
 = 
	`MÆloc
(
„©uª_node
*,sub¥ob.
l
);

2457 
sub¥ob
.
y
 = 
	`MÆloc
(,sub¥ob.
l
);

2459 
k
=0;

2460 
j
=0;j<
begö
;j++)

2462 
sub¥ob
.
x
[
k
] = 
¥ob
->x[
≥rm
[
j
]];

2463 
sub¥ob
.
y
[
k
] = 
¥ob
->y[
≥rm
[
j
]];

2464 ++
k
;

2466 
j
=
íd
;j<
l
;j++)

2468 
sub¥ob
.
x
[
k
] = 
¥ob
->x[
≥rm
[
j
]];

2469 
sub¥ob
.
y
[
k
] = 
¥ob
->y[
≥rm
[
j
]];

2470 ++
k
;

2472 
modñ
 *
submodñ
 = 
	`åaö
(&
sub¥ob
,
∑øm
);

2473 
j
=
begö
;j<
íd
;j++)

2474 
èrgë
[
≥rm
[
j
]] = 
	`¥edi˘
(
submodñ
,
¥ob
->
x
[perm[j]]);

2475 
	`‰ì_™d_de°roy_modñ
(&
submodñ
);

2476 
	`‰ì
(
sub¥ob
.
x
);

2477 
	`‰ì
(
sub¥ob
.
y
);

2479 
	`‰ì
(
fﬁd_°¨t
);

2480 
	`‰ì
(
≥rm
);

2481 
	}
}

2483 
	$¥edi˘_vÆues
(c⁄° 
modñ
 *
modñ_
, c⁄° 
„©uª_node
 *
x
, *
dec_vÆues
)

2485 
idx
;

2486 
n
;

2487 if(
modñ_
->
büs
>=0)

2488 
n
=
modñ_
->
ƒ_„©uª
+1;

2490 
n
=
modñ_
->
ƒ_„©uª
;

2491 *
w
=
modñ_
->w;

2492 
ƒ_˛ass
=
modñ_
->nr_class;

2493 
i
;

2494 
ƒ_w
;

2495 if(
ƒ_˛ass
==2 && 
modñ_
->
∑øm
.
sﬁvî_ty≥
 !
MCSVM_CS
)

2496 
ƒ_w
 = 1;

2498 
ƒ_w
 = 
ƒ_˛ass
;

2500 c⁄° 
„©uª_node
 *
lx
=
x
;

2501 
i
=0;i<
ƒ_w
;i++)

2502 
dec_vÆues
[
i
] = 0;

2503 ; (
idx
=
lx
->
ödex
)!=-1;Üx++)

2506 if(
idx
<=
n
)

2507 
i
=0;i<
ƒ_w
;i++)

2508 
dec_vÆues
[
i
] +
w
[(
idx
-1)*
ƒ_w
+i]*
lx
->
vÆue
;

2511 if(
ƒ_˛ass
==2)

2513 if(
	`check_ªgªssi⁄_modñ
(
modñ_
))

2514  
dec_vÆues
[0];

2516  (
dec_vÆues
[0]>0)?
modñ_
->
œbñ
[0]:model_->label[1];

2520 
dec_max_idx
 = 0;

2521 
i
=1;i<
ƒ_˛ass
;i++)

2523 if(
dec_vÆues
[
i
] > dec_vÆues[
dec_max_idx
])

2524 
dec_max_idx
 = 
i
;

2526  
modñ_
->
œbñ
[
dec_max_idx
];

2528 
	}
}

2530 
	$¥edi˘
(c⁄° 
modñ
 *
modñ_
, c⁄° 
„©uª_node
 *
x
)

2532 *
dec_vÆues
 = 
	`MÆloc
(, 
modñ_
->
ƒ_˛ass
);

2533 
œbñ
=
	`¥edi˘_vÆues
(
modñ_
, 
x
, 
dec_vÆues
);

2534 
	`‰ì
(
dec_vÆues
);

2535  
œbñ
;

2536 
	}
}

2538 
	$¥edi˘_¥obabûôy
(c⁄° 
modñ
 *
modñ_
, c⁄° 
„©uª_node
 *
x
, * 
¥ob_e°im©es
)

2540 if(
	`check_¥obabûôy_modñ
(
modñ_
))

2542 
i
;

2543 
ƒ_˛ass
=
modñ_
->nr_class;

2544 
ƒ_w
;

2545 if(
ƒ_˛ass
==2)

2546 
ƒ_w
 = 1;

2548 
ƒ_w
 = 
ƒ_˛ass
;

2550 
œbñ
=
	`¥edi˘_vÆues
(
modñ_
, 
x
, 
¥ob_e°im©es
);

2551 
i
=0;i<
ƒ_w
;i++)

2552 
¥ob_e°im©es
[
i
]=1/(1+
	`exp
(-prob_estimates[i]));

2554 if(
ƒ_˛ass
==2)

2555 
¥ob_e°im©es
[1]=1.-prob_estimates[0];

2558 
sum
=0;

2559 
i
=0; i<
ƒ_˛ass
; i++)

2560 
sum
+=
¥ob_e°im©es
[
i
];

2562 
i
=0; i<
ƒ_˛ass
; i++)

2563 
¥ob_e°im©es
[
i
]ırob_e°im©es[i]/
sum
;

2566  
œbñ
;

2570 
	}
}

2572 c⁄° *
	gsﬁvî_ty≥_èbÀ
[]=

2577 "L2R_L2LOSS_SVR", "L2R_L2LOSS_SVR_DUAL", "L2R_L1LOSS_SVR_DUAL", 
NULL


2580 
	$ßve_modñ
(c⁄° *
modñ_fûe_«me
, c⁄° 
modñ
 *
modñ_
)

2582 
i
;

2583 
ƒ_„©uª
=
modñ_
->nr_feature;

2584 
n
;

2585 c⁄° 
∑ømëî
& 
∑øm
 = 
modñ_
->param;

2587 if(
modñ_
->
büs
>=0)

2588 
n
=
ƒ_„©uª
+1;

2590 
n
=
ƒ_„©uª
;

2591 
w_size
 = 
n
;

2592 
FILE
 *
Â
 = 
	`f›í
(
modñ_fûe_«me
,"w");

2593 if(
Â
==
NULL
)  -1;

2595 *
ﬁd_loˇÀ
 = 
	`°rdup
(
	`£éoˇÀ
(
LC_ALL
, 
NULL
));

2596 
	`£éoˇÀ
(
LC_ALL
, "C");

2598 
ƒ_w
;

2599 if(
modñ_
->
ƒ_˛ass
==2 && modñ_->
∑øm
.
sﬁvî_ty≥
 !
MCSVM_CS
)

2600 
ƒ_w
=1;

2602 
ƒ_w
=
modñ_
->
ƒ_˛ass
;

2604 
	`Ârötf
(
Â
, "sﬁvî_ty≥ %s\n", 
sﬁvî_ty≥_èbÀ
[
∑øm
.
sﬁvî_ty≥
]);

2605 
	`Ârötf
(
Â
, "ƒ_˛as†%d\n", 
modñ_
->
ƒ_˛ass
);

2607 if(
modñ_
->
œbñ
)

2609 
	`Ârötf
(
Â
, "label");

2610 
i
=0; i<
modñ_
->
ƒ_˛ass
; i++)

2611 
	`Ârötf
(
Â
, " %d", 
modñ_
->
œbñ
[
i
]);

2612 
	`Ârötf
(
Â
, "\n");

2615 
	`Ârötf
(
Â
, "ƒ_„©uª %d\n", 
ƒ_„©uª
);

2617 
	`Ârötf
(
Â
, "bü†%.16g\n", 
modñ_
->
büs
);

2619 
	`Ârötf
(
Â
, "w\n");

2620 
i
=0; i<
w_size
; i++)

2622 
j
;

2623 
j
=0; j<
ƒ_w
; j++)

2624 
	`Ârötf
(
Â
, "%.16g ", 
modñ_
->
w
[
i
*
ƒ_w
+
j
]);

2625 
	`Ârötf
(
Â
, "\n");

2628 
	`£éoˇÀ
(
LC_ALL
, 
ﬁd_loˇÀ
);

2629 
	`‰ì
(
ﬁd_loˇÀ
);

2631 i‡(
	`„º‹
(
Â
Ë!0 || 
	`f˛o£
(fp) != 0)  -1;

2633 
	}
}

2635 
modñ
 *
	$lﬂd_modñ
(c⁄° *
modñ_fûe_«me
)

2637 
FILE
 *
Â
 = 
	`f›í
(
modñ_fûe_«me
,"r");

2638 if(
Â
==
NULL
)  NULL;

2640 
i
;

2641 
ƒ_„©uª
;

2642 
n
;

2643 
ƒ_˛ass
;

2644 
büs
;

2645 
modñ
 *
modñ_
 = 
	`MÆloc
(model,1);

2646 
∑ømëî
& 
∑øm
 = 
modñ_
->param;

2648 
modñ_
->
œbñ
 = 
NULL
;

2650 *
ﬁd_loˇÀ
 = 
	`°rdup
(
	`£éoˇÀ
(
LC_ALL
, 
NULL
));

2651 
	`£éoˇÀ
(
LC_ALL
, "C");

2653 
cmd
[81];

2656 
	`fsˇnf
(
Â
,"%80s",
cmd
);

2657 if(
	`°rcmp
(
cmd
,"solver_type")==0)

2659 
	`fsˇnf
(
Â
,"%80s",
cmd
);

2660 
i
;

2661 
i
=0;
sﬁvî_ty≥_èbÀ
[i];i++)

2663 if(
	`°rcmp
(
sﬁvî_ty≥_èbÀ
[
i
],
cmd
)==0)

2665 
∑øm
.
sﬁvî_ty≥
=
i
;

2669 if(
sﬁvî_ty≥_èbÀ
[
i
] =
NULL
)

2671 
	`Ârötf
(
°dîr
,"unknown solverÅype.\n");

2673 
	`£éoˇÀ
(
LC_ALL
, 
ﬁd_loˇÀ
);

2674 
	`‰ì
(
modñ_
->
œbñ
);

2675 
	`‰ì
(
modñ_
);

2676 
	`‰ì
(
ﬁd_loˇÀ
);

2677  
NULL
;

2680 if(
	`°rcmp
(
cmd
,"nr_class")==0)

2682 
	`fsˇnf
(
Â
,"%d",&
ƒ_˛ass
);

2683 
modñ_
->
ƒ_˛ass
=nr_class;

2685 if(
	`°rcmp
(
cmd
,"nr_feature")==0)

2687 
	`fsˇnf
(
Â
,"%d",&
ƒ_„©uª
);

2688 
modñ_
->
ƒ_„©uª
=nr_feature;

2690 if(
	`°rcmp
(
cmd
,"bias")==0)

2692 
	`fsˇnf
(
Â
,"%lf",&
büs
);

2693 
modñ_
->
büs
=bias;

2695 if(
	`°rcmp
(
cmd
,"w")==0)

2699 if(
	`°rcmp
(
cmd
,"label")==0)

2701 
ƒ_˛ass
 = 
modñ_
->nr_class;

2702 
modñ_
->
œbñ
 = 
	`MÆloc
(,
ƒ_˛ass
);

2703 
i
=0;i<
ƒ_˛ass
;i++)

2704 
	`fsˇnf
(
Â
,"%d",&
modñ_
->
œbñ
[
i
]);

2708 
	`Ârötf
(
°dîr
,"unknow¿ãxàö modñ fûe: [%s]\n",
cmd
);

2709 
	`£éoˇÀ
(
LC_ALL
, 
ﬁd_loˇÀ
);

2710 
	`‰ì
(
modñ_
->
œbñ
);

2711 
	`‰ì
(
modñ_
);

2712 
	`‰ì
(
ﬁd_loˇÀ
);

2713  
NULL
;

2717 
ƒ_„©uª
=
modñ_
->nr_feature;

2718 if(
modñ_
->
büs
>=0)

2719 
n
=
ƒ_„©uª
+1;

2721 
n
=
ƒ_„©uª
;

2722 
w_size
 = 
n
;

2723 
ƒ_w
;

2724 if(
ƒ_˛ass
==2 && 
∑øm
.
sﬁvî_ty≥
 !
MCSVM_CS
)

2725 
ƒ_w
 = 1;

2727 
ƒ_w
 = 
ƒ_˛ass
;

2729 
modñ_
->
w
=
	`MÆloc
(, 
w_size
*
ƒ_w
);

2730 
i
=0; i<
w_size
; i++)

2732 
j
;

2733 
j
=0; j<
ƒ_w
; j++)

2734 
	`fsˇnf
(
Â
, "%l‡", &
modñ_
->
w
[
i
*
ƒ_w
+
j
]);

2735 
	`fsˇnf
(
Â
, "\n");

2738 
	`£éoˇÀ
(
LC_ALL
, 
ﬁd_loˇÀ
);

2739 
	`‰ì
(
ﬁd_loˇÀ
);

2741 i‡(
	`„º‹
(
Â
Ë!0 || 
	`f˛o£
(ÂË!0Ë 
NULL
;

2743  
modñ_
;

2744 
	}
}

2746 
	$gë_ƒ_„©uª
(c⁄° 
modñ
 *
modñ_
)

2748  
modñ_
->
ƒ_„©uª
;

2749 
	}
}

2751 
	$gë_ƒ_˛ass
(c⁄° 
modñ
 *
modñ_
)

2753  
modñ_
->
ƒ_˛ass
;

2754 
	}
}

2756 
	$gë_œbñs
(c⁄° 
modñ
 *
modñ_
, * 
œbñ
)

2758 i‡(
modñ_
->
œbñ
 !
NULL
)

2759 
i
=0;i<
modñ_
->
ƒ_˛ass
;i++)

2760 
œbñ
[
i
] = 
modñ_
->label[i];

2761 
	}
}

2764 
ölöe
 
	$gë_w_vÆue
(c⁄° 
modñ
 *
modñ_
, 
idx
, 
œbñ_idx
)

2766 
ƒ_˛ass
 = 
modñ_
->nr_class;

2767 
sﬁvî_ty≥
 = 
modñ_
->
∑øm
.solver_type;

2768 c⁄° *
w
 = 
modñ_
->w;

2770 if(
idx
 < 0 || idx > 
modñ_
->
ƒ_„©uª
)

2772 if(
	`check_ªgªssi⁄_modñ
(
modñ_
))

2773  
w
[
idx
];

2776 if(
œbñ_idx
 < 0 ||Üabñ_idx >
ƒ_˛ass
)

2778 if(
ƒ_˛ass
 =2 && 
sﬁvî_ty≥
 !
MCSVM_CS
)

2780 if(
œbñ_idx
 == 0)

2781  
w
[
idx
];

2783  -
w
[
idx
];

2786  
w
[
idx
*
ƒ_˛ass
+
œbñ_idx
];

2788 
	}
}

2793 
	$gë_decfun_c€f
(c⁄° 
modñ
 *
modñ_
, 
„©_idx
, 
œbñ_idx
)

2795 if(
„©_idx
 > 
modñ_
->
ƒ_„©uª
)

2797  
	`gë_w_vÆue
(
modñ_
, 
„©_idx
-1, 
œbñ_idx
);

2798 
	}
}

2800 
	$gë_decfun_büs
(c⁄° 
modñ
 *
modñ_
, 
œbñ_idx
)

2802 
büs_idx
 = 
modñ_
->
ƒ_„©uª
;

2803 
büs
 = 
modñ_
->bias;

2804 if(
büs
 <= 0)

2807  
büs
*
	`gë_w_vÆue
(
modñ_
, 
büs_idx
, 
œbñ_idx
);

2808 
	}
}

2810 
	$‰ì_modñ_c⁄ã¡
(
modñ
 *
modñ_±r
)

2812 if(
modñ_±r
->
w
 !
NULL
)

2813 
	`‰ì
(
modñ_±r
->
w
);

2814 if(
modñ_±r
->
œbñ
 !
NULL
)

2815 
	`‰ì
(
modñ_±r
->
œbñ
);

2816 
	}
}

2818 
	$‰ì_™d_de°roy_modñ
(
modñ
 **
modñ_±r_±r
)

2820 
modñ
 *
modñ_±r
 = *
modñ_±r_±r
;

2821 if(
modñ_±r
 !
NULL
)

2823 
	`‰ì_modñ_c⁄ã¡
(
modñ_±r
);

2824 
	`‰ì
(
modñ_±r
);

2826 
	}
}

2828 
	$de°roy_∑øm
(
∑ømëî
* 
∑øm
)

2830 if(
∑øm
->
weight_œbñ
 !
NULL
)

2831 
	`‰ì
(
∑øm
->
weight_œbñ
);

2832 if(
∑øm
->
weight
 !
NULL
)

2833 
	`‰ì
(
∑øm
->
weight
);

2834 
	}
}

2836 c⁄° *
	$check_∑ømëî
(c⁄° 
¥obÀm
 *
¥ob
, c⁄° 
∑ømëî
 *
∑øm
)

2838 if(
∑øm
->
ïs
 <= 0)

2841 if(
∑øm
->
C
 <= 0)

2844 if(
∑øm
->
p
 < 0)

2847 if(
∑øm
->
sﬁvî_ty≥
 !
L2R_LR


2848 && 
∑øm
->
sﬁvî_ty≥
 !
L2R_L2LOSS_SVC_DUAL


2849 && 
∑øm
->
sﬁvî_ty≥
 !
L2R_L2LOSS_SVC


2850 && 
∑øm
->
sﬁvî_ty≥
 !
L2R_L1LOSS_SVC_DUAL


2851 && 
∑øm
->
sﬁvî_ty≥
 !
MCSVM_CS


2852 && 
∑øm
->
sﬁvî_ty≥
 !
L1R_L2LOSS_SVC


2853 && 
∑øm
->
sﬁvî_ty≥
 !
L1R_LR


2854 && 
∑øm
->
sﬁvî_ty≥
 !
L2R_LR_DUAL


2855 && 
∑øm
->
sﬁvî_ty≥
 !
L2R_L2LOSS_SVR


2856 && 
∑øm
->
sﬁvî_ty≥
 !
L2R_L2LOSS_SVR_DUAL


2857 && 
∑øm
->
sﬁvî_ty≥
 !
L2R_L1LOSS_SVR_DUAL
)

2860  
NULL
;

2861 
	}
}

2863 
	$check_¥obabûôy_modñ
(c⁄° 
modñ
 *
modñ_
)

2865  (
modñ_
->
∑øm
.
sﬁvî_ty≥
==
L2R_LR
 ||

2866 
modñ_
->
∑øm
.
sﬁvî_ty≥
==
L2R_LR_DUAL
 ||

2867 
modñ_
->
∑øm
.
sﬁvî_ty≥
==
L1R_LR
);

2868 
	}
}

2870 
	$check_ªgªssi⁄_modñ
(c⁄° 
modñ
 *
modñ_
)

2872  (
modñ_
->
∑øm
.
sﬁvî_ty≥
==
L2R_L2LOSS_SVR
 ||

2873 
modñ_
->
∑øm
.
sﬁvî_ty≥
==
L2R_L1LOSS_SVR_DUAL
 ||

2874 
modñ_
->
∑øm
.
sﬁvî_ty≥
==
L2R_L2LOSS_SVR_DUAL
);

2875 
	}
}

2877 
£t_¥öt_°rög_fun˘i⁄
((*
¥öt_func
)(const *))

2879 i‡(
¥öt_func
 =
NULL
)

2880 
liblöór_¥öt_°rög
 = &
¥öt_°rög_°dout
;

2882 
liblöór_¥öt_°rög
 = 
¥öt_func
;

2883 
	}
}

	@linear.h

1 #i‚de‡
_LIBLINEAR_H


2 
	#_LIBLINEAR_H


	)

4 #ifde‡
__˝lu•lus


8 
	s„©uª_node


10 
ödex
;

11 
vÆue
;

14 
	s¥obÀm


16 
l
, 
n
;

17 *
y
;

18 
„©uª_node
 **
x
;

19 
büs
;

22 íum { 
L2R_LR
, 
L2R_L2LOSS_SVC_DUAL
, 
L2R_L2LOSS_SVC
, 
L2R_L1LOSS_SVC_DUAL
, 
MCSVM_CS
, 
L1R_L2LOSS_SVC
, 
L1R_LR
, 
L2R_LR_DUAL
, 
L2R_L2LOSS_SVR
 = 11, 
L2R_L2LOSS_SVR_DUAL
, 
L2R_L1LOSS_SVR_DUAL
 };

24 
	s∑ømëî


26 
sﬁvî_ty≥
;

29 
ïs
;

30 
C
;

31 
ƒ_weight
;

32 *
weight_œbñ
;

33 * 
weight
;

34 
p
;

37 
	smodñ


39 
∑ømëî
 
∑øm
;

40 
ƒ_˛ass
;

41 
ƒ_„©uª
;

42 *
w
;

43 *
œbñ
;

44 
büs
;

47 
modñ
* 
åaö
(c⁄° 
¥obÀm
 *
¥ob
, c⁄° 
∑ømëî
 *
∑øm
);

48 
¸oss_vÆid©i⁄
(c⁄° 
¥obÀm
 *
¥ob
, c⁄° 
∑ømëî
 *
∑øm
, 
ƒ_fﬁd
, *
èrgë
);

50 
¥edi˘_vÆues
(c⁄° 
modñ
 *
modñ_
, c⁄° 
„©uª_node
 *
x
, * 
dec_vÆues
);

51 
¥edi˘
(c⁄° 
modñ
 *
modñ_
, c⁄° 
„©uª_node
 *
x
);

52 
¥edi˘_¥obabûôy
(c⁄° 
modñ
 *
modñ_
, c⁄° 
„©uª_node
 *
x
, * 
¥ob_e°im©es
);

54 
ßve_modñ
(c⁄° *
modñ_fûe_«me
, c⁄° 
modñ
 *
modñ_
);

55 
modñ
 *
lﬂd_modñ
(c⁄° *
modñ_fûe_«me
);

57 
gë_ƒ_„©uª
(c⁄° 
modñ
 *
modñ_
);

58 
gë_ƒ_˛ass
(c⁄° 
modñ
 *
modñ_
);

59 
gë_œbñs
(c⁄° 
modñ
 *
modñ_
, * 
œbñ
);

60 
gë_decfun_c€f
(c⁄° 
modñ
 *
modñ_
, 
„©_idx
, 
œbñ_idx
);

61 
gë_decfun_büs
(c⁄° 
modñ
 *
modñ_
, 
œbñ_idx
);

63 
‰ì_modñ_c⁄ã¡
(
modñ
 *
modñ_±r
);

64 
‰ì_™d_de°roy_modñ
(
modñ
 **
modñ_±r_±r
);

65 
de°roy_∑øm
(
∑ømëî
 *
∑øm
);

67 c⁄° *
check_∑ømëî
(c⁄° 
¥obÀm
 *
¥ob
, c⁄° 
∑ømëî
 *
∑øm
);

68 
check_¥obabûôy_modñ
(c⁄° 
modñ
 *model);

69 
check_ªgªssi⁄_modñ
(c⁄° 
modñ
 *model);

70 
£t_¥öt_°rög_fun˘i⁄
((*
¥öt_func
) (const *));

72 #ifde‡
__˝lu•lus


	@predict.c

1 
	~<°dio.h
>

2 
	~<˘y≥.h
>

3 
	~<°dlib.h
>

4 
	~<°rög.h
>

5 
	~<î∫o.h
>

6 
	~"löór.h
"

8 
	$¥öt_nuŒ
(c⁄° *
s
,...Ë{ 0;
	}
}

10 (*
öfo
)(c⁄° *
fmt
,...Ë&
¥ötf
;

12 
„©uª_node
 *
x
;

13 
max_ƒ_©å
 = 64;

15 
modñ
* 
modñ_
;

16 
Êag_¥edi˘_¥obabûôy
=0;

18 
	$exô_öput_îr‹
(
löe_num
)

20 
	`Ârötf
(
°dîr
,"Wr⁄g i≈uàf‹m©áàlöê%d\n", 
löe_num
);

21 
	`exô
(1);

22 
	}
}

24 *
	glöe
 = 
NULL
;

25 
	gmax_löe_Àn
;

27 * 
	$ªadlöe
(
FILE
 *
öput
)

29 
Àn
;

31 if(
	`fgës
(
löe
,
max_löe_Àn
,
öput
Ë=
NULL
)

32  
NULL
;

34 
	`°ºchr
(
löe
,'\n'Ë=
NULL
)

36 
max_löe_Àn
 *= 2;

37 
löe
 = (*Ë
	`ªÆloc
÷öe,
max_löe_Àn
);

38 
Àn
 = (Ë
	`°æí
(
löe
);

39 if(
	`fgës
(
löe
+
Àn
,
max_löe_Àn
-Àn,
öput
Ë=
NULL
)

42  
löe
;

43 
	}
}

45 
	$do_¥edi˘
(
FILE
 *
öput
, FILE *
ouçut
)

47 
c‹ª˘
 = 0;

48 
tŸÆ
 = 0;

49 
îr‹
 = 0;

50 
sump
 = 0, 
sumt
 = 0, 
sumµ
 = 0, 
sumâ
 = 0, 
sum±
 = 0;

52 
ƒ_˛ass
=
	`gë_ƒ_˛ass
(
modñ_
);

53 *
¥ob_e°im©es
=
NULL
;

54 
j
, 
n
;

55 
ƒ_„©uª
=
	`gë_ƒ_„©uª
(
modñ_
);

56 if(
modñ_
->
büs
>=0)

57 
n
=
ƒ_„©uª
+1;

59 
n
=
ƒ_„©uª
;

61 if(
Êag_¥edi˘_¥obabûôy
)

63 *
œbñs
;

65 if(!
	`check_¥obabûôy_modñ
(
modñ_
))

67 
	`Ârötf
(
°dîr
, "probability output is only supported forÜogisticÑegression\n");

68 
	`exô
(1);

71 
œbñs
=(*Ë
	`mÆloc
(
ƒ_˛ass
*());

72 
	`gë_œbñs
(
modñ_
,
œbñs
);

73 
¥ob_e°im©es
 = (*Ë
	`mÆloc
(
ƒ_˛ass
*());

74 
	`Ârötf
(
ouçut
,"labels");

75 
j
=0;j<
ƒ_˛ass
;j++)

76 
	`Ârötf
(
ouçut
," %d",
œbñs
[
j
]);

77 
	`Ârötf
(
ouçut
,"\n");

78 
	`‰ì
(
œbñs
);

81 
max_löe_Àn
 = 1024;

82 
löe
 = (*)
	`mÆloc
(
max_löe_Àn
*());

83 
	`ªadlöe
(
öput
Ë!
NULL
)

85 
i
 = 0;

86 
èrgë_œbñ
, 
¥edi˘_œbñ
;

87 *
idx
, *
vÆ
, *
œbñ
, *
íd±r
;

88 
ö°_max_ödex
 = 0;

90 
œbñ
 = 
	`°πok
(
löe
," \t\n");

91 if(
œbñ
 =
NULL
)

92 
	`exô_öput_îr‹
(
tŸÆ
+1);

94 
èrgë_œbñ
 = 
	`°πod
(
œbñ
,&
íd±r
);

95 if(
íd±r
 =
œbñ
 || *endptr != '\0')

96 
	`exô_öput_îr‹
(
tŸÆ
+1);

100 if(
i
>=
max_ƒ_©å
-2)

102 
max_ƒ_©å
 *= 2;

103 
x
 = (
„©uª_node
 *Ë
	`ªÆloc
(x,
max_ƒ_©å
*(feature_node));

106 
idx
 = 
	`°πok
(
NULL
,":");

107 
vÆ
 = 
	`°πok
(
NULL
," \t");

109 if(
vÆ
 =
NULL
)

111 
î∫o
 = 0;

112 
x
[
i
].
ödex
 = (Ë
	`°πﬁ
(
idx
,&
íd±r
,10);

113 if(
íd±r
 =
idx
 || 
î∫o
 !0 || *íd±∏!'\0' || 
x
[
i
].
ödex
 <
ö°_max_ödex
)

114 
	`exô_öput_îr‹
(
tŸÆ
+1);

116 
ö°_max_ödex
 = 
x
[
i
].
ödex
;

118 
î∫o
 = 0;

119 
x
[
i
].
vÆue
 = 
	`°πod
(
vÆ
,&
íd±r
);

120 if(
íd±r
 =
vÆ
 || 
î∫o
 !0 || (*íd±∏!'\0' && !
	`is•a˚
(*endptr)))

121 
	`exô_öput_îr‹
(
tŸÆ
+1);

124 if(
x
[
i
].
ödex
 <
ƒ_„©uª
)

125 ++
i
;

128 if(
modñ_
->
büs
>=0)

130 
x
[
i
].
ödex
 = 
n
;

131 
x
[
i
].
vÆue
 = 
modñ_
->
büs
;

132 
i
++;

134 
x
[
i
].
ödex
 = -1;

136 if(
Êag_¥edi˘_¥obabûôy
)

138 
j
;

139 
¥edi˘_œbñ
 = 
	`¥edi˘_¥obabûôy
(
modñ_
,
x
,
¥ob_e°im©es
);

140 
	`Ârötf
(
ouçut
,"%g",
¥edi˘_œbñ
);

141 
j
=0;j<
modñ_
->
ƒ_˛ass
;j++)

142 
	`Ârötf
(
ouçut
," %g",
¥ob_e°im©es
[
j
]);

143 
	`Ârötf
(
ouçut
,"\n");

147 
¥edi˘_œbñ
 = 
	`¥edi˘
(
modñ_
,
x
);

148 
	`Ârötf
(
ouçut
,"%g\n",
¥edi˘_œbñ
);

151 if(
¥edi˘_œbñ
 =
èrgë_œbñ
)

152 ++
c‹ª˘
;

153 
îr‹
 +(
¥edi˘_œbñ
-
èrgë_œbñ
)*(predict_label-target_label);

154 
sump
 +
¥edi˘_œbñ
;

155 
sumt
 +
èrgë_œbñ
;

156 
sumµ
 +
¥edi˘_œbñ
*predict_label;

157 
sumâ
 +
èrgë_œbñ
*target_label;

158 
sum±
 +
¥edi˘_œbñ
*
èrgë_œbñ
;

159 ++
tŸÆ
;

161 if(
	`check_ªgªssi⁄_modñ
(
modñ_
))

163 
	`öfo
("Mó¿squ¨edÉº‹ = %g (ªgªssi⁄)\n",
îr‹
/
tŸÆ
);

164 
	`öfo
("Squared correlation coefficient = %g (regression)\n",

165 ((
tŸÆ
*
sum±
-
sump
*
sumt
)*(total*sumpt-sump*sumt))/

166 ((
tŸÆ
*
sumµ
-
sump
*sump)*—ŸÆ*
sumâ
-
sumt
*sumt))

170 
	`öfo
("Accuøcy = %g%% (%d/%d)\n",(Ë
c‹ª˘
/
tŸÆ
*100,correct,total);

171 if(
Êag_¥edi˘_¥obabûôy
)

172 
	`‰ì
(
¥ob_e°im©es
);

173 
	}
}

175 
	$exô_wôh_hñp
()

177 
	`¥ötf
(

183 
	`exô
(1);

184 
	}
}

186 
	$maö
(
¨gc
, **
¨gv
)

188 
FILE
 *
öput
, *
ouçut
;

189 
i
;

192 
i
=1;i<
¨gc
;i++)

194 if(
¨gv
[
i
][0] != '-') ;

195 ++
i
;

196 
¨gv
[
i
-1][1])

199 
Êag_¥edi˘_¥obabûôy
 = 
	`©oi
(
¨gv
[
i
]);

202 
öfo
 = &
¥öt_nuŒ
;

203 
i
--;

206 
	`Ârötf
(
°dîr
,"unknow¿›ti⁄: -%c\n", 
¨gv
[
i
-1][1]);

207 
	`exô_wôh_hñp
();

211 if(
i
>=
¨gc
)

212 
	`exô_wôh_hñp
();

214 
öput
 = 
	`f›í
(
¨gv
[
i
],"r");

215 if(
öput
 =
NULL
)

217 
	`Ârötf
(
°dîr
,"ˇn'à›í i≈uàfûê%s\n",
¨gv
[
i
]);

218 
	`exô
(1);

221 
ouçut
 = 
	`f›í
(
¨gv
[
i
+2],"w");

222 if(
ouçut
 =
NULL
)

224 
	`Ârötf
(
°dîr
,"ˇn'à›í ouçuàfûê%s\n",
¨gv
[
i
+2]);

225 
	`exô
(1);

228 if((
modñ_
=
	`lﬂd_modñ
(
¨gv
[
i
+1]))==0)

230 
	`Ârötf
(
°dîr
,"ˇn'à›í modñ fûê%s\n",
¨gv
[
i
+1]);

231 
	`exô
(1);

234 
x
 = (
„©uª_node
 *Ë
	`mÆloc
(
max_ƒ_©å
*(feature_node));

235 
	`do_¥edi˘
(
öput
, 
ouçut
);

236 
	`‰ì_™d_de°roy_modñ
(&
modñ_
);

237 
	`‰ì
(
löe
);

238 
	`‰ì
(
x
);

239 
	`f˛o£
(
öput
);

240 
	`f˛o£
(
ouçut
);

242 
	}
}

	@train.c

1 
	~<°dio.h
>

2 
	~<m©h.h
>

3 
	~<°dlib.h
>

4 
	~<°rög.h
>

5 
	~<˘y≥.h
>

6 
	~<î∫o.h
>

7 
	~"löór.h
"

8 
	#MÆloc
(
ty≥
,
n
Ë—y≥ *)
	`mÆloc
(“)*—y≥))

	)

9 
	#INF
 
HUGE_VAL


	)

11 
	$¥öt_nuŒ
(c⁄° *
s
Ë{
	}
}

13 
	$exô_wôh_hñp
()

15 
	`¥ötf
(

54 
	`exô
(1);

55 
	}
}

57 
	$exô_öput_îr‹
(
löe_num
)

59 
	`Ârötf
(
°dîr
,"Wr⁄g i≈uàf‹m©áàlöê%d\n", 
löe_num
);

60 
	`exô
(1);

61 
	}
}

63 *
	glöe
 = 
NULL
;

64 
	gmax_löe_Àn
;

66 * 
	$ªadlöe
(
FILE
 *
öput
)

68 
Àn
;

70 if(
	`fgës
(
löe
,
max_löe_Àn
,
öput
Ë=
NULL
)

71  
NULL
;

73 
	`°ºchr
(
löe
,'\n'Ë=
NULL
)

75 
max_löe_Àn
 *= 2;

76 
löe
 = (*Ë
	`ªÆloc
÷öe,
max_löe_Àn
);

77 
Àn
 = (Ë
	`°æí
(
löe
);

78 if(
	`fgës
(
löe
+
Àn
,
max_löe_Àn
-Àn,
öput
Ë=
NULL
)

81  
löe
;

82 
	}
}

84 
∑r£_comm™d_löe
(
¨gc
, **
¨gv
, *
öput_fûe_«me
, *
modñ_fûe_«me
);

85 
ªad_¥obÀm
(c⁄° *
fûíame
);

86 
do_¸oss_vÆid©i⁄
();

88 
„©uª_node
 *
	gx_•a˚
;

89 
∑ømëî
 
	g∑øm
;

90 
¥obÀm
 
	g¥ob
;

91 
modñ
* 
	gmodñ_
;

92 
	gÊag_¸oss_vÆid©i⁄
;

93 
	gƒ_fﬁd
;

94 
	gbüs
;

96 
	$maö
(
¨gc
, **
¨gv
)

98 
öput_fûe_«me
[1024];

99 
modñ_fûe_«me
[1024];

100 c⁄° *
îr‹_msg
;

102 
	`∑r£_comm™d_löe
(
¨gc
, 
¨gv
, 
öput_fûe_«me
, 
modñ_fûe_«me
);

103 
	`ªad_¥obÀm
(
öput_fûe_«me
);

104 
îr‹_msg
 = 
	`check_∑ømëî
(&
¥ob
,&
∑øm
);

106 if(
îr‹_msg
)

108 
	`Ârötf
(
°dîr
,"ERROR: %s\n",
îr‹_msg
);

109 
	`exô
(1);

112 if(
Êag_¸oss_vÆid©i⁄
)

114 
	`do_¸oss_vÆid©i⁄
();

118 
modñ_
=
	`åaö
(&
¥ob
, &
∑øm
);

119 if(
	`ßve_modñ
(
modñ_fûe_«me
, 
modñ_
))

121 
	`Ârötf
(
°dîr
,"ˇn'àßvêmodñÅÿfûê%s\n",
modñ_fûe_«me
);

122 
	`exô
(1);

124 
	`‰ì_™d_de°roy_modñ
(&
modñ_
);

126 
	`de°roy_∑øm
(&
∑øm
);

127 
	`‰ì
(
¥ob
.
y
);

128 
	`‰ì
(
¥ob
.
x
);

129 
	`‰ì
(
x_•a˚
);

130 
	`‰ì
(
löe
);

133 
	}
}

135 
	$do_¸oss_vÆid©i⁄
()

137 
i
;

138 
tŸÆ_c‹ª˘
 = 0;

139 
tŸÆ_îr‹
 = 0;

140 
sumv
 = 0, 
sumy
 = 0, 
sumvv
 = 0, 
sumyy
 = 0, 
sumvy
 = 0;

141 *
èrgë
 = 
	`MÆloc
(, 
¥ob
.
l
);

143 
	`¸oss_vÆid©i⁄
(&
¥ob
,&
∑øm
,
ƒ_fﬁd
,
èrgë
);

144 if(
∑øm
.
sﬁvî_ty≥
 =
L2R_L2LOSS_SVR
 ||

145 
∑øm
.
sﬁvî_ty≥
 =
L2R_L1LOSS_SVR_DUAL
 ||

146 
∑øm
.
sﬁvî_ty≥
 =
L2R_L2LOSS_SVR_DUAL
)

148 
i
=0;i<
¥ob
.
l
;i++)

150 
y
 = 
¥ob
.y[
i
];

151 
v
 = 
èrgë
[
i
];

152 
tŸÆ_îr‹
 +(
v
-
y
)*(v-y);

153 
sumv
 +
v
;

154 
sumy
 +
y
;

155 
sumvv
 +
v
*v;

156 
sumyy
 +
y
*y;

157 
sumvy
 +
v
*
y
;

159 
	`¥ötf
("Cros†VÆid©i⁄ Mó¿squ¨edÉº‹ = %g\n",
tŸÆ_îr‹
/
¥ob
.
l
);

160 
	`¥ötf
("Cross Validation Squared correlation coefficient = %g\n",

161 ((
¥ob
.
l
*
sumvy
-
sumv
*
sumy
)*(prob.l*sumvy-sumv*sumy))/

162 ((
¥ob
.
l
*
sumvv
-
sumv
*sumv)*’rob.l*
sumyy
-
sumy
*sumy))

167 
i
=0;i<
¥ob
.
l
;i++)

168 if(
èrgë
[
i
] =
¥ob
.
y
[i])

169 ++
tŸÆ_c‹ª˘
;

170 
	`¥ötf
("Cros†VÆid©i⁄ Accuøcy = %g%%\n",100.0*
tŸÆ_c‹ª˘
/
¥ob
.
l
);

173 
	`‰ì
(
èrgë
);

174 
	}
}

176 
	$∑r£_comm™d_löe
(
¨gc
, **
¨gv
, *
öput_fûe_«me
, *
modñ_fûe_«me
)

178 
i
;

179 (*
¥öt_func
)(c⁄° *Ë
NULL
;

182 
∑øm
.
sﬁvî_ty≥
 = 
L2R_L2LOSS_SVC_DUAL
;

183 
∑øm
.
C
 = 1;

184 
∑øm
.
ïs
 = 
INF
;

185 
∑øm
.
p
 = 0.1;

186 
∑øm
.
ƒ_weight
 = 0;

187 
∑øm
.
weight_œbñ
 = 
NULL
;

188 
∑øm
.
weight
 = 
NULL
;

189 
Êag_¸oss_vÆid©i⁄
 = 0;

190 
büs
 = -1;

193 
i
=1;i<
¨gc
;i++)

195 if(
¨gv
[
i
][0] != '-') ;

196 if(++
i
>=
¨gc
)

197 
	`exô_wôh_hñp
();

198 
¨gv
[
i
-1][1])

201 
∑øm
.
sﬁvî_ty≥
 = 
	`©oi
(
¨gv
[
i
]);

205 
∑øm
.
C
 = 
	`©of
(
¨gv
[
i
]);

209 
∑øm
.
p
 = 
	`©of
(
¨gv
[
i
]);

213 
∑øm
.
ïs
 = 
	`©of
(
¨gv
[
i
]);

217 
büs
 = 
	`©of
(
¨gv
[
i
]);

221 ++
∑øm
.
ƒ_weight
;

222 
∑øm
.
weight_œbñ
 = (*Ë
	`ªÆloc
’¨am.weight_œbñ,()*∑øm.
ƒ_weight
);

223 
∑øm
.
weight
 = (*Ë
	`ªÆloc
’¨am.weight,()*∑øm.
ƒ_weight
);

224 
∑øm
.
weight_œbñ
[∑øm.
ƒ_weight
-1] = 
	`©oi
(&
¨gv
[
i
-1][2]);

225 
∑øm
.
weight
[∑øm.
ƒ_weight
-1] = 
	`©of
(
¨gv
[
i
]);

229 
Êag_¸oss_vÆid©i⁄
 = 1;

230 
ƒ_fﬁd
 = 
	`©oi
(
¨gv
[
i
]);

231 if(
ƒ_fﬁd
 < 2)

233 
	`Ârötf
(
°dîr
,"n-fold cross validation:Ç must >= 2\n");

234 
	`exô_wôh_hñp
();

239 
¥öt_func
 = &
¥öt_nuŒ
;

240 
i
--;

244 
	`Ârötf
(
°dîr
,"unknow¿›ti⁄: -%c\n", 
¨gv
[
i
-1][1]);

245 
	`exô_wôh_hñp
();

250 
	`£t_¥öt_°rög_fun˘i⁄
(
¥öt_func
);

253 if(
i
>=
¨gc
)

254 
	`exô_wôh_hñp
();

256 
	`°r˝y
(
öput_fûe_«me
, 
¨gv
[
i
]);

258 if(
i
<
¨gc
-1)

259 
	`°r˝y
(
modñ_fûe_«me
,
¨gv
[
i
+1]);

262 *
p
 = 
	`°ºchr
(
¨gv
[
i
],'/');

263 if(
p
==
NULL
)

264 
p
 = 
¨gv
[
i
];

266 ++
p
;

267 
	`•rötf
(
modñ_fûe_«me
,"%s.modñ",
p
);

270 if(
∑øm
.
ïs
 =
INF
)

272 
∑øm
.
sﬁvî_ty≥
)

274 
L2R_LR
:

275 
L2R_L2LOSS_SVC
:

276 
∑øm
.
ïs
 = 0.01;

278 
L2R_L2LOSS_SVR
:

279 
∑øm
.
ïs
 = 0.001;

281 
L2R_L2LOSS_SVC_DUAL
:

282 
L2R_L1LOSS_SVC_DUAL
:

283 
MCSVM_CS
:

284 
L2R_LR_DUAL
:

285 
∑øm
.
ïs
 = 0.1;

287 
L1R_L2LOSS_SVC
:

288 
L1R_LR
:

289 
∑øm
.
ïs
 = 0.01;

291 
L2R_L1LOSS_SVR_DUAL
:

292 
L2R_L2LOSS_SVR_DUAL
:

293 
∑øm
.
ïs
 = 0.1;

297 
	}
}

300 
	$ªad_¥obÀm
(c⁄° *
fûíame
)

302 
max_ödex
, 
ö°_max_ödex
, 
i
;

303 
size_t
 
ñemíts
, 
j
;

304 
FILE
 *
Â
 = 
	`f›í
(
fûíame
,"r");

305 *
íd±r
;

306 *
idx
, *
vÆ
, *
œbñ
;

308 if(
Â
 =
NULL
)

310 
	`Ârötf
(
°dîr
,"ˇn'à›í i≈uàfûê%s\n",
fûíame
);

311 
	`exô
(1);

314 
¥ob
.
l
 = 0;

315 
ñemíts
 = 0;

316 
max_löe_Àn
 = 1024;

317 
löe
 = 
	`MÆloc
(,
max_löe_Àn
);

318 
	`ªadlöe
(
Â
)!=
NULL
)

320 *
p
 = 
	`°πok
(
löe
," \t");

325 
p
 = 
	`°πok
(
NULL
," \t");

326 if(
p
 =
NULL
 || *p == '\n')

328 
ñemíts
++;

330 
ñemíts
++;

331 
¥ob
.
l
++;

333 
	`ªwöd
(
Â
);

335 
¥ob
.
büs
=bias;

337 
¥ob
.
y
 = 
	`MÆloc
(,¥ob.
l
);

338 
¥ob
.
x
 = 
	`MÆloc
(
„©uª_node
 *,¥ob.
l
);

339 
x_•a˚
 = 
	`MÆloc
(
„©uª_node
,
ñemíts
+
¥ob
.
l
);

341 
max_ödex
 = 0;

342 
j
=0;

343 
i
=0;i<
¥ob
.
l
;i++)

345 
ö°_max_ödex
 = 0;

346 
	`ªadlöe
(
Â
);

347 
¥ob
.
x
[
i
] = &
x_•a˚
[
j
];

348 
œbñ
 = 
	`°πok
(
löe
," \t\n");

349 if(
œbñ
 =
NULL
)

350 
	`exô_öput_îr‹
(
i
+1);

352 
¥ob
.
y
[
i
] = 
	`°πod
(
œbñ
,&
íd±r
);

353 if(
íd±r
 =
œbñ
 || *endptr != '\0')

354 
	`exô_öput_îr‹
(
i
+1);

358 
idx
 = 
	`°πok
(
NULL
,":");

359 
vÆ
 = 
	`°πok
(
NULL
," \t");

361 if(
vÆ
 =
NULL
)

364 
î∫o
 = 0;

365 
x_•a˚
[
j
].
ödex
 = (Ë
	`°πﬁ
(
idx
,&
íd±r
,10);

366 if(
íd±r
 =
idx
 || 
î∫o
 !0 || *íd±∏!'\0' || 
x_•a˚
[
j
].
ödex
 <
ö°_max_ödex
)

367 
	`exô_öput_îr‹
(
i
+1);

369 
ö°_max_ödex
 = 
x_•a˚
[
j
].
ödex
;

371 
î∫o
 = 0;

372 
x_•a˚
[
j
].
vÆue
 = 
	`°πod
(
vÆ
,&
íd±r
);

373 if(
íd±r
 =
vÆ
 || 
î∫o
 !0 || (*íd±∏!'\0' && !
	`is•a˚
(*endptr)))

374 
	`exô_öput_îr‹
(
i
+1);

376 ++
j
;

379 if(
ö°_max_ödex
 > 
max_ödex
)

380 
max_ödex
 = 
ö°_max_ödex
;

382 if(
¥ob
.
büs
 >= 0)

383 
x_•a˚
[
j
++].
vÆue
 = 
¥ob
.
büs
;

385 
x_•a˚
[
j
++].
ödex
 = -1;

388 if(
¥ob
.
büs
 >= 0)

390 
¥ob
.
n
=
max_ödex
+1;

391 
i
=1;i<
¥ob
.
l
;i++)

392 (
¥ob
.
x
[
i
]-2)->
ödex
 =Örob.
n
;

393 
x_•a˚
[
j
-2].
ödex
 = 
¥ob
.
n
;

396 
¥ob
.
n
=
max_ödex
;

398 
	`f˛o£
(
Â
);

399 
	}
}

	@tron.cpp

1 
	~<m©h.h
>

2 
	~<°dio.h
>

3 
	~<°rög.h
>

4 
	~<°d¨g.h
>

5 
	~"å⁄.h
"

7 #i‚de‡
mö


8 
	gãm∂©e
 <
˛ass
 
	gT
> 
ölöe
 
T
 
	$mö
(
T
 
x
,T 
y
Ë{  (x<y)?x:y; 
	}
}

11 #i‚de‡
max


12 
	gãm∂©e
 <
˛ass
 
	gT
> 
ölöe
 
T
 
	$max
(
T
 
x
,T 
y
Ë{  (x>y)?x:y; 
	}
}

15 #ifde‡
__˝lu•lus


19 
dƒm2_
(*, *, *);

20 
ddŸ_
(*, *, *, *, *);

21 
daxpy_
(*, *, *, *, *, *);

22 
dsˇl_
(*, *, *, *);

24 #ifde‡
__˝lu•lus


28 
	$deÁu…_¥öt
(c⁄° *
buf
)

30 
	`Âuts
(
buf
,
°dout
);

31 
	`fÊush
(
°dout
);

32 
	}
}

34 
	gTRON
::
	$öfo
(c⁄° *
fmt
,...)

36 
buf
[
BUFSIZ
];

37 
va_li°
 
≠
;

38 
	`va_°¨t
(
≠
,
fmt
);

39 
	`v•rötf
(
buf
,
fmt
,
≠
);

40 
	`va_íd
(
≠
);

41 (*
å⁄_¥öt_°rög
)(
buf
);

42 
	}
}

44 
	gTRON
::
	$TRON
(c⁄° 
fun˘i⁄
 *
fun_obj
, 
ïs
, 
max_ôî
)

46 
this
->
fun_obj
=
c⁄°_ˇ°
<
fun˘i⁄
 *>(fun_obj);

47 
this
->
ïs
=eps;

48 
this
->
max_ôî
=max_iter;

49 
å⁄_¥öt_°rög
 = 
deÁu…_¥öt
;

50 
	}
}

52 
	gTRON
::~
	$TRON
()

54 
	}
}

56 
TRON
::
	$å⁄
(*
w
)

59 
ëa0
 = 1e-4, 
ëa1
 = 0.25, 
ëa2
 = 0.75;

62 
sigma1
 = 0.25, 
sigma2
 = 0.5, 
sigma3
 = 4;

64 
n
 = 
fun_obj
->
	`gë_ƒ_v¨übÀ
();

65 
i
, 
cg_ôî
;

66 
dñè
, 
¢‹m
, 
⁄e
=1.0;

67 
Æpha
, 
f
, 
‚ew
, 
¥îed
, 
a˘ªd
, 
gs
;

68 
£¨ch
 = 1, 
ôî
 = 1, 
öc
 = 1;

69 *
s
 = 
√w
 [
n
];

70 *
r
 = 
√w
 [
n
];

71 *
w_√w
 = 
√w
 [
n
];

72 *
g
 = 
√w
 [
n
];

74 
i
=0; i<
n
; i++)

75 
w
[
i
] = 0;

77 
f
 = 
fun_obj
->
	`fun
(
w
);

78 
fun_obj
->
	`gød
(
w
, 
g
);

79 
dñè
 = 
	`dƒm2_
(&
n
, 
g
, &
öc
);

80 
gn‹m1
 = 
dñè
;

81 
gn‹m
 = 
gn‹m1
;

83 i‡(
gn‹m
 <
ïs
*
gn‹m1
)

84 
£¨ch
 = 0;

86 
ôî
 = 1;

88 
ôî
 <
max_ôî
 && 
£¨ch
)

90 
cg_ôî
 = 
	`åcg
(
dñè
, 
g
, 
s
, 
r
);

92 
	`mem˝y
(
w_√w
, 
w
, ()*
n
);

93 
	`daxpy_
(&
n
, &
⁄e
, 
s
, &
öc
, 
w_√w
, &inc);

95 
gs
 = 
	`ddŸ_
(&
n
, 
g
, &
öc
, 
s
, &inc);

96 
¥îed
 = -0.5*(
gs
-
	`ddŸ_
(&
n
, 
s
, &
öc
, 
r
, &inc));

97 
‚ew
 = 
fun_obj
->
	`fun
(
w_√w
);

100 
a˘ªd
 = 
f
 - 
‚ew
;

103 
¢‹m
 = 
	`dƒm2_
(&
n
, 
s
, &
öc
);

104 i‡(
ôî
 == 1)

105 
dñè
 = 
	`mö
(dñè, 
¢‹m
);

108 i‡(
‚ew
 - 
f
 - 
gs
 <= 0)

109 
Æpha
 = 
sigma3
;

111 
Æpha
 = 
	`max
(
sigma1
, -0.5*(
gs
/(
‚ew
 - 
f
 - gs)));

114 i‡(
a˘ªd
 < 
ëa0
*
¥îed
)

115 
dñè
 = 
	`mö
(
	`max
(
Æpha
, 
sigma1
)*
¢‹m
, 
sigma2
*delta);

116 i‡(
a˘ªd
 < 
ëa1
*
¥îed
)

117 
dñè
 = 
	`max
(
sigma1
*dñè, 
	`mö
(
Æpha
*
¢‹m
, 
sigma2
*delta));

118 i‡(
a˘ªd
 < 
ëa2
*
¥îed
)

119 
dñè
 = 
	`max
(
sigma1
*dñè, 
	`mö
(
Æpha
*
¢‹m
, 
sigma3
*delta));

121 
dñè
 = 
	`max
(dñè, 
	`mö
(
Æpha
*
¢‹m
, 
sigma3
*delta));

123 
	`öfo
("ôî %2dá˘ %5.3ê¥ê%5.3êdñè %5.3ê‡%5.3ê|g| %5.3êCG %3d\n", 
ôî
, 
a˘ªd
, 
¥îed
, 
dñè
, 
f
, 
gn‹m
, 
cg_ôî
);

125 i‡(
a˘ªd
 > 
ëa0
*
¥îed
)

127 
ôî
++;

128 
	`mem˝y
(
w
, 
w_√w
, ()*
n
);

129 
f
 = 
‚ew
;

130 
fun_obj
->
	`gød
(
w
, 
g
);

132 
gn‹m
 = 
	`dƒm2_
(&
n
, 
g
, &
öc
);

133 i‡(
gn‹m
 <
ïs
*
gn‹m1
)

136 i‡(
f
 < -1.0e+32)

138 
	`öfo
("WARNING: f < -1.0e+32\n");

141 i‡(
	`Ábs
(
a˘ªd
Ë<0 && 
¥îed
 <= 0)

143 
	`öfo
("WARNING:áctredándÖrered <= 0\n");

146 i‡(
	`Ábs
(
a˘ªd
Ë<1.0e-12*Ábs(
f
) &&

147 
	`Ábs
(
¥îed
Ë<1.0e-12*Ábs(
f
))

149 
	`öfo
("WARNING:áctredándÖreredÅoo small\n");

154 
dñëe
[] 
g
;

155 
dñëe
[] 
r
;

156 
dñëe
[] 
w_√w
;

157 
dñëe
[] 
s
;

158 
	}
}

160 
	gTRON
::
	$åcg
(
dñè
, *
g
, *
s
, *
r
)

162 
i
, 
öc
 = 1;

163 
n
 = 
fun_obj
->
	`gë_ƒ_v¨übÀ
();

164 
⁄e
 = 1;

165 *
d
 = 
√w
 [
n
];

166 *
Hd
 = 
√w
 [
n
];

167 
rTr
, 
∫ewT∫ew
, 
Æpha
, 
bëa
, 
cgtﬁ
;

169 
i
=0; i<
n
; i++)

171 
s
[
i
] = 0;

172 
r
[
i
] = -
g
[i];

173 
d
[
i
] = 
r
[i];

175 
cgtﬁ
 = 0.1*
	`dƒm2_
(&
n
, 
g
, &
öc
);

177 
cg_ôî
 = 0;

178 
rTr
 = 
	`ddŸ_
(&
n
, 
r
, &
öc
,Ñ, &inc);

181 i‡(
	`dƒm2_
(&
n
, 
r
, &
öc
Ë<
cgtﬁ
)

183 
cg_ôî
++;

184 
fun_obj
->
	`Hv
(
d
, 
Hd
);

186 
Æpha
 = 
rTr
/
	`ddŸ_
(&
n
, 
d
, &
öc
, 
Hd
, &inc);

187 
	`daxpy_
(&
n
, &
Æpha
, 
d
, &
öc
, 
s
, &inc);

188 i‡(
	`dƒm2_
(&
n
, 
s
, &
öc
Ë> 
dñè
)

190 
	`öfo
("cgÑeachesÅrustÑegion boundary\n");

191 
Æpha
 = -alpha;

192 
	`daxpy_
(&
n
, &
Æpha
, 
d
, &
öc
, 
s
, &inc);

194 
°d
 = 
	`ddŸ_
(&
n
, 
s
, &
öc
, 
d
, &inc);

195 
°s
 = 
	`ddŸ_
(&
n
, 
s
, &
öc
, s, &inc);

196 
dtd
 = 
	`ddŸ_
(&
n
, 
d
, &
öc
, d, &inc);

197 
dsq
 = 
dñè
*delta;

198 
ød
 = 
	`sqπ
(
°d
*°d + 
dtd
*(
dsq
-
°s
));

199 i‡(
°d
 >= 0)

200 
Æpha
 = (
dsq
 - 
°s
)/(
°d
 + 
ød
);

202 
Æpha
 = (
ød
 - 
°d
)/
dtd
;

203 
	`daxpy_
(&
n
, &
Æpha
, 
d
, &
öc
, 
s
, &inc);

204 
Æpha
 = -alpha;

205 
	`daxpy_
(&
n
, &
Æpha
, 
Hd
, &
öc
, 
r
, &inc);

208 
Æpha
 = -alpha;

209 
	`daxpy_
(&
n
, &
Æpha
, 
Hd
, &
öc
, 
r
, &inc);

210 
∫ewT∫ew
 = 
	`ddŸ_
(&
n
, 
r
, &
öc
,Ñ, &inc);

211 
bëa
 = 
∫ewT∫ew
/
rTr
;

212 
	`dsˇl_
(&
n
, &
bëa
, 
d
, &
öc
);

213 
	`daxpy_
(&
n
, &
⁄e
, 
r
, &
öc
, 
d
, &inc);

214 
rTr
 = 
∫ewT∫ew
;

217 
dñëe
[] 
d
;

218 
dñëe
[] 
Hd
;

220 (
cg_ôî
);

221 
	}
}

223 
	gTRON
::
	$n‹m_öf
(
n
, *
x
)

225 
dmax
 = 
	`Ábs
(
x
[0]);

226 
i
=1; i<
n
; i++)

227 i‡(
	`Ábs
(
x
[
i
]Ë>
dmax
)

228 
dmax
 = 
	`Ábs
(
x
[
i
]);

229 (
dmax
);

230 
	}
}

232 
	gTRON
::
£t_¥öt_°rög
((*
¥öt_°rög
Ë(c⁄° *
buf
))

234 
å⁄_¥öt_°rög
 = 
¥öt_°rög
;

235 
	}
}

	@tron.h

1 #i‚de‡
_TRON_H


2 
	#_TRON_H


	)

4 ˛as†
	cfun˘i⁄


6 
	mpublic
:

7 
vútuÆ
 
fun
(*
w
) = 0 ;

8 
vútuÆ
 
gød
(*
w
, *
g
) = 0 ;

9 
vútuÆ
 
Hv
(*
s
, *
Hs
) = 0 ;

11 
vútuÆ
 
gë_ƒ_v¨übÀ
() = 0 ;

12 
	mvútuÆ
 ~
	$fun˘i⁄
(){}

13 
	}
};

15 ˛as†
	cTRON


17 
	mpublic
:

18 
TRON
(c⁄° 
fun˘i⁄
 *
fun_obj
, 
ïs
 = 0.1, 
max_ôî
 = 1000);

19 ~
TRON
();

21 
å⁄
(*
w
);

22 
£t_¥öt_°rög
((*
i_¥öt
Ë(c⁄° *
buf
));

24 
¥iv©e
:

25 
	`åcg
(
dñè
, *
g
, *
s
, *
r
);

26 
	`n‹m_öf
(
n
, *
x
);

28 
ïs
;

29 
max_ôî
;

30 
fun˘i⁄
 *
fun_obj
;

31 
	`öfo
(c⁄° *
fmt
,...);

32 (*
å⁄_¥öt_°rög
)(c⁄° *
buf
);

	@
1
.
0
12
130
blas/blas.h
blas/blasp.h
blas/daxpy.c
blas/ddot.c
blas/dnrm2.c
blas/dscal.c
linear.cpp
linear.h
predict.c
train.c
tron.cpp
tron.h
